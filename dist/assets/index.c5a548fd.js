var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,s=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,a=(e,a)=>{for(var o in a||(a={}))t.call(a,o)&&s(e,o,a[o]);if(r)for(var o of r(a))n.call(a,o)&&s(e,o,a[o]);return e},o=(e,t,r)=>(s(e,"symbol"!=typeof t?t+"":t,r),r);import{D as l,h as i,a as c,e as d,i as m,b as u,S as p,E,F as h,c as y,C as f,d as v,I as g,H as _,M as w,L as b,B as I,G as S,R as C,f as j,g as R,j as T,k as O,U as k,l as x,m as A,P,A as L,n as q,o as D,p as B,q as V,T as H,W as N,r as z,s as F,t as M,u as J,v as $,w as U}from"./vendor.7e2a13b2.js";let W;!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(r){const n=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((r,a)=>{const o=new URL(e,n);if(self[t].moduleMap[o])return r(self[t].moduleMap[o]);const l=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){a(new Error(`Failed to import: ${e}`)),s(i)},onload(){r(self[t].moduleMap[o]),s(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/geliver/assets/");const G={},K=function(e,t){if(!t)return e();if(void 0===W){const e=document.createElement("link").relList;W=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in G)return;G[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":W,t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e()))};const Y=/^[\],:{}\s]*$/,Q=/\\(?:["\\/bfnrt]|u[0-9a-fA-F]{4})/g,X=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?/g,Z=/(?:^|:|,)(?:\s*\[)+/g,ee=async function(e="GET",t="",r={},n={}){const s=function(e,t){let r=e;t&&""!=l.stringify(t)&&(r+="?"+l.stringify(t));return r}(t,"GET"===e?r:void 0),a=Object.assign({},n),o={method:e,headers:a,mode:"cors"};if(console.log("FetchURI      : ",e,s),console.log("FetchHeader   : ",a),"GET"!==e){const e=JSON.stringify(r);Object.assign(o,{body:e}),console.log("FetchBody     : ",r)}try{const e=await fetch(s,o),t=await e.text();if(console.log(e),console.log("FetchResponse : ",t),!(i=t).length||!Y.test(i.replace(Q,"@").replace(X,"]").replace(Z,"")))throw new Error(t);return JSON.parse(t)}catch(c){throw c}var i};class te{constructor(){o(this,"reloadServerEndpoints",(async(e,t)=>await ee("GET",e,{},{"x-oscrud-dev":t}))),o(this,"sendRequest",(async(e,t,r,n)=>await ee("POST",e,{endpoint:t,request:r},{"x-oscrud-dev":n})))}}class re{constructor(){o(this,"getTheme",(()=>localStorage.getItem("oscrud.theme"))),o(this,"setTheme",(e=>{localStorage.setItem("oscrud.theme",e)})),o(this,"getAppTheme",(()=>localStorage.getItem("oscrud.app_theme"))),o(this,"setAppTheme",(e=>{localStorage.setItem("oscrud.app_theme",e)}))}}function ne(){return i().format("x")+function(e){const t=[];for(let r=0;r<e;r++)t.push(Math.floor(10*Math.random()).toString());return t.join("")}(4)}let se=new c("geliver",{addons:[]});se.version(1).stores({histories:"&id, serverId, endpoint, createdAt",servers:"&id, name, connection, updatedAt",collections:"&id, name, tag, updatedAt",presets:"&id, name, collectionId, serverId, endpoint, updatedAt"});const ae=async(e,t="",r="id",n=!0,s=10)=>{t&&(e=e.where(r),e=n?e.belowOrEqual(t):e.aboveOrEqual(t));let a=e.limit(s+1);n&&(a=a.reverse());const o=await a.sortBy(r);let l;return o.length===s+1&&(l=o.pop()[r]),[o,l]};class oe{constructor(e){o(this,"exportDatabase",(async(e=(()=>{}))=>await d(se,{progressCallback:e}))),o(this,"importDatabase",(async(e,t=(()=>{}))=>{await se.delete(),await se.open(),await m(se,e,{progressCallback:t})})),o(this,"checkServerIdValid",(async e=>void 0===await se.servers.where("id").equals(e).first())),o(this,"getCollectionById",(async e=>se.collections.where("id").equals(e).first())),o(this,"getPresetById",(async e=>se.presets.where("id").equals(e).first())),o(this,"getServerById",(async e=>se.servers.where("id").equals(e).first())),o(this,"getConnectionById",(async e=>{const t=await se.servers.where("id").equals(e).first();return null==t?void 0:t.connection})),o(this,"listServers",(async e=>{let t=se.servers;return e&&(t=t.where("name").startsWithAnyOf(e)),t.limit(50).toArray()})),o(this,"listCollectionsWithSearch",(async e=>{let t=se.collections;return e&&(t=t.where("name").startsWithAnyOf(e)),t.limit(50).toArray()})),o(this,"listEndpoints",(async(e,t)=>{if(!e)return[];const r=await se.servers.where("id").equals(e).first();let n=(null==r?void 0:r.endpoints)||[];return t&&(n=n.filter((e=>e.endpoint.toLowerCase().includes(t.toLowerCase())))),n})),o(this,"listCollections",(async e=>ae(se.collections,e,"name",!1,8))),o(this,"listPresetsByCollectionId",(async(e,t)=>ae(se.presets.where("collectionId").equals(t),e,"name",!1,8))),o(this,"listHistories",(async e=>{const t={},r=async e=>(t[e]||(t[e]=this.getConnectionById(e)),t[e]),[n,s]=await ae(se.histories,e,"createdAt",!0,8),a=Promise.all(n.map((async e=>Object.assign(e,{connection:await r(e.serverId)}))));return[await a,s]})),o(this,"modifyServerEndpointsById",(async(e,t)=>{await se.servers.where("id").equals(e).modify({endpoints:t,updatedAt:i.utc().valueOf()})})),o(this,"modifyServerById",(async(e,t,r,n,s)=>{await se.servers.where("id").equals(e).modify({name:t,connection:r,password:n,endpoints:s,updatedAt:i.utc().valueOf()})})),o(this,"modifyCollectionById",(async(e,t,r)=>{await se.collections.where("id").equals(e).modify({name:t,tag:r,updatedAt:i.utc().valueOf()})})),o(this,"modifyPresetById",(async(e,t,r,n,s)=>{await se.presets.where("id").equals(id).modify({name:e,collectionId:t,serverId:r,endpoint:n,request:s,updatedAt:i.utc().valueOf()})})),o(this,"createCollection",(async(e,t)=>{await se.collections.put({id:ne(),updatedAt:i.utc().valueOf(),name:e,tag:t})})),o(this,"createPreset",(async(e,t,r,n,s)=>{await se.presets.put({id:ne(),updatedAt:i.utc().valueOf(),name:e,collectionId:t,serverId:r,endpoint:n,request:s})})),o(this,"createServer",(async(e,t,r,n,s)=>{await se.servers.put({id:e,name:t,connection:r,password:n,endpoints:s,updatedAt:i.utc().valueOf()})})),o(this,"createHistory",(async(e,t,r,n,s)=>{await se.histories.put({id:ne(),serverId:e,endpoint:t,request:r,response:n,isError:s,createdAt:i.utc().valueOf()})})),o(this,"upsertPreset",(async(e,t,r,n,s)=>{e||(e=ne()),await se.presets.put({id:e,name:t,serverId:r,endpoint:n,request:s,updatedAt:i.utc().valueOf()})})),o(this,"deletePresetById",(async e=>{await se.presets.where("id").equals(e).delete()})),o(this,"deleteCollectionById",(async e=>{await se.collections.where("id").equals(e).delete()})),o(this,"deleteHistoryById",(async e=>{await se.histories.where("id").equals(e).delete()})),o(this,"clearHistory",(async()=>{await se.histories.clear()})),this.root=e}}class le{constructor(){o(this,"getRequestJSON",(()=>this.request.jsonEditor.get())),o(this,"setRequestTheme",(e=>{this.request.jsonEditor.aceEditor.setTheme(`ace/theme/${e}`)})),o(this,"setResponseTheme",(e=>{this.response.jsonEditor.aceEditor.setTheme(`ace/theme/${e}`)})),o(this,"getAceTheme",(e=>`ace/theme/${e}`)),o(this,"setResponseJSON",(e=>{try{const t=JSON.parse(e);this.response.jsonEditor.set(t)}catch(t){this.response.jsonEditor.set(e)}})),o(this,"setRequestJSON",(e=>{try{const t=JSON.parse(e);this.request.jsonEditor.set(t)}catch(t){this.request.jsonEditor.set(e)}})),this.request=null,this.response=null,this.historyController={}}}const ie=new class{constructor(){this.api=new te(this),this.view=new le(this),this.storage=new re(this),this.db=new oe(this)}},ce=u.createContext(ie),{StringType:de}=p.Types;function me({open:e,selectedServerId:t,onClose:r}){const n=u.useRef(),s=u.useContext(ce),[a,o]=u.useState(!1),[l,i]=u.useState({}),[c,d]=u.useState(void 0);let m=de().isRequired("Server id is required");t||(m=m.addRule((async e=>s.db.checkServerIdValid(e)),"Server id must be unique."));const S=p.Model({serverId:m,name:de().isRequired("Name is required"),connection:de().isRequired("Connection is required").addRule((e=>e.includes("https://")||e.includes("http://")),"Connection must have protocol HTTP or HTTPS.")});u.useEffect((()=>{i({}),t&&async function(){const e=await s.db.getServerById(t);i({serverId:t,name:e.name,connection:e.connection,password:e.password})}()}),[t]);return u.createElement(E,{show:e,size:"xs",onClose:r},u.createElement(E.Header,{closeButton:!1},u.createElement(E.Title,null,t?"Edit":"Add"," Server")),u.createElement(E.Body,null,u.createElement(h,{ref:n,fluid:!0,model:S,formValue:l,onChange:i},u.createElement(y,null,u.createElement(f,null,"SID"),u.createElement(v,{name:"serverId",accepter:g,disabled:void 0!==t}),u.createElement(_,null,"SID is an unique identifier for preset and history to determine server connection configuration. It's will always make sure connection is up to date.")),u.createElement(y,null,u.createElement(f,null,"Name"),u.createElement(v,{name:"name",accepter:g})),u.createElement(y,null,u.createElement(f,null,"Connection"),u.createElement(v,{name:"connection",accepter:g}),u.createElement(_,null,"Example connection: http://localhost:1234")),u.createElement(y,null,u.createElement(f,null,"Password"),u.createElement(v,{name:"password",type:"password"}),u.createElement(_,null,"Leave it empty if doesn't enabled password authentication"))),c&&u.createElement(w,{type:"error",showIcon:!0,description:c.message})),u.createElement(E.Footer,{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},a?u.createElement(b,{style:{marginRight:10},content:(t?"Updating":"Creating")+" ..."}):u.createElement(I,{appearance:"primary",onClick:async()=>{const{hasError:e}=await n.current.checkAsync();if(!e){d(void 0),o(!0);try{const e=await s.api.reloadServerEndpoints(l.connection,l.password);t?await s.db.modifyServerById(l.serverId,l.name,l.connection,l.password,e):await s.db.createServer(l.serverId,l.name,l.connection,l.password,e),r()}catch(a){d(a)}finally{o(!1)}}}},"Confirm"),u.createElement(I,{appearance:"subtle",onClick:r},"Cancel")))}const ue=["ambiance","chaos","chrome","clouds","clouds_midnight","cobalt","crimson_editor","dawn","dracula","dreamweaver","eclipse","github","gob","gruvbox","idle_fingers","iplastic","katzenmilch","kr_theme","kuroir","merbivore","merbivore_soft","monokai","mono_industrial","pastel_on_dark","solarized_dark","solarized_light","sqlserver","terminal","textmate","tomorrow","tomorrow_night","tomorrow_night_blue","tomorrow_night_bright","tomorrow_night_eighties","twilight","vibrant_ink","xcode"];function pe({theme:e,setTheme:t,appTheme:r,setAppTheme:n}){const s=u.useContext(ce),[o,l]=u.useState(!1),[i,c]=u.useState(!1),[d,m]=u.useState(void 0),p=()=>{l(void 0)};return u.createElement(S,{fluid:!0},u.createElement(C,{style:{display:"flex",alignItems:"center"}},u.createElement(j,{xs:2},u.createElement("p",null,"Editor Theme")),u.createElement(j,{xs:6},u.createElement(R,{block:!0,value:e,onChange:t,data:ue.map((e=>({label:e,value:e})))}))),u.createElement(C,{style:{display:"flex",alignItems:"center",marginTop:15}},u.createElement(j,{xs:2},u.createElement("p",null,"App Theme")),u.createElement(j,{xs:22},u.createElement(T,{inline:!0,value:r,onChange:n},u.createElement(O,{value:"light"},"☀️ Light"),u.createElement(O,{value:"dark"},"🌙 Dark")),u.createElement(_,null,"Sometimes may not working, refresh should take the changes."))),u.createElement(C,{style:{display:"flex",alignItems:"center",marginTop:15}},u.createElement(j,{xs:2},u.createElement("p",null,"Actions")),u.createElement(j,{xs:22,style:{display:"flex",flexDirection:"row"}},u.createElement(k,{fileListVisible:!1,autoUpload:!1,action:"",onChange:async e=>{c("import");try{s.db.importDatabase(e[0].blobFile,(e=>m(a({},e))))}catch(t){m({error:t,done:!0})}}},u.createElement(I,null,u.createElement(x,{icon:"import"})," Import Data")),u.createElement(I,{style:{marginLeft:10},appearance:"primary",onClick:async()=>{c("export");try{const e=await s.db.exportDatabase((e=>m(a({},e))));A(e,"geliver.json","application/json")}catch(e){m({error:e,done:!0})}}},u.createElement(x,{icon:"export"})," Export Data"),u.createElement(I,{style:{marginLeft:10},appearance:"primary",onClick:()=>l(!0)},u.createElement(x,{icon:"trash"})," Clear History"))),u.createElement(E,{show:void 0!==d,overflow:!1,size:"xs"},u.createElement(E.Header,{closeButton:!1},u.createElement(E.Title,null,u.createElement(x,{icon:"export"===i?"export":"import",style:{marginRight:10}}),"export"===i?"Exporting":"Importing"," Data")),u.createElement(E.Body,{style:{display:"flex",justifyContent:"center",flexDirection:"row"}},u.createElement(P.Circle,{style:{width:120},percent:Math.floor((null==d?void 0:d.completedRows)/(null==d?void 0:d.totalRows)*100),status:(null==d?void 0:d.done)?d.error?"fail":"success":"active"}),u.createElement("dl",{style:{marginLeft:30}},u.createElement("dt",null,"Num Of Tables:"),u.createElement("dd",null,null==d?void 0:d.totalTables),u.createElement("dt",null,"Num Of Rows:"),u.createElement("dd",null,null==d?void 0:d.completedRows," / ",null==d?void 0:d.totalRows))),(null==d?void 0:d.error)&&u.createElement(w,{type:"error",title:"Import Error",description:null==d?void 0:d.error.message}),(null==d?void 0:d.done)&&u.createElement(E.Footer,null,u.createElement(I,{appearance:"primary",onClick:()=>{m(void 0)}},"Close"))),u.createElement(E,{backdrop:!0,show:o,onHide:p,size:"xs"},u.createElement(E.Header,{closeButton:!1},u.createElement(E.Title,null,u.createElement(x,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Clear histories")),u.createElement(E.Body,null,"Histories once cleared will not be recover anymore. Are you sure want to proceed?"),u.createElement(E.Footer,null,u.createElement(I,{appearance:"primary",onClick:async()=>{L.info("Clearing histories ...");try{await s.db.clearHistory(),p(),L.success("Clear histories successfully"),s.view.historyController.refresh()}catch(e){L.error("Error when clearing histories: ",e.message)}}},"Ok"),u.createElement(I,{onClick:p,appearance:"subtle"},"Cancel"))))}const Ee=Promise.resolve([[],void 0]);function he(e){const[t,r]=u.useState(!1),[n,s]=u.useState(!1),[a,o]=u.useState(!1),[l,i]=u.useState(),[c,d]=u.useState([]);u.useEffect((()=>{a||n||(s(!0),async function(){const[t,r]=await e(l);d(l?[...c,...t]:[...t]),i(r),r||o(!0),s(!1)}())}),[t]);return[{loading:n,isEnd:a,refresh:()=>{n||(i(void 0),o(!1),r(!t))},loadMore:()=>{a||n||r(!t)}},c]}const{StringType:ye}=p.Types;function fe({open:e,selectedCollectionId:t,onClose:r}){const n=u.useRef(),s=u.useContext(ce),[a,o]=u.useState(!1),[l,i]=u.useState({}),[c,d]=u.useState(void 0),m=p.Model({name:ye().isRequired("Name is required")});u.useEffect((()=>{i({}),t&&async function(){const e=await s.db.getCollectionById(t);i({name:e.name,tag:e.tag})}()}),[t]);return u.createElement(E,{show:e,size:"xs",onHide:r},u.createElement(E.Header,{closeButton:!1},u.createElement(E.Title,null,t?"Edit":"Create"," Collection")),u.createElement(E.Body,null,u.createElement(h,{ref:n,fluid:!0,model:m,formValue:l,onChange:i},u.createElement(y,null,u.createElement(f,null,"Name"),u.createElement(v,{name:"name",accepter:g})),u.createElement(y,null,u.createElement(f,null,"Tag"),u.createElement(v,{name:"tag",accepter:g}),u.createElement(_,null,"Tag is just for display purpse, usually for specify development, staging or production. You can use as ur own recognize purpose."))),c&&u.createElement(w,{type:"error",showIcon:!0,description:c.message})),u.createElement(E.Footer,{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},a?u.createElement(b,{style:{marginRight:10},content:(t?"Updating":"Creating")+" ..."}):u.createElement(I,{appearance:"primary",onClick:async()=>{const{hasError:e}=await n.current.checkAsync();if(!e){d(void 0),o(!0);try{t?await s.db.modifyCollectionById(t,l.name,l.tag):await s.db.createCollection(l.name,l.tag),r()}catch(a){d(a)}finally{o(!1)}}}},"Confirm"),u.createElement(I,{appearance:"subtle",onClick:r},"Cancel")))}const{StringType:ve}=p.Types;function ge({open:e,selectedPresetId:t,onClose:r}){const n=u.useRef(),s=u.useRef(),a=u.useContext(ce),[o,l]=u.useState(!1),[i,c]=u.useState({}),[d,m]=u.useState(void 0),[S,C]=u.useState([]),[j,T]=u.useState([]),[O,k]=u.useState([]),[x,A]=u.useState(),[P,L]=u.useState(),[B,V]=u.useState(),H=p.Model({name:ve().isRequired("Name is required"),collectionId:ve().isRequired("Collection is required"),serverId:ve().isRequired("Server is required"),endpoint:ve().isRequired("Endpoint is required")});u.useEffect((()=>{c({}),t&&async function(){const e=await a.db.getPresetById(t);s.current.jsonEditor.set(e.request),c({name:e.name,collectionId:e.collectionId,serverId:e.serverId,endpoint:e.endpoint,request:e.request})}()}),[t]),u.useEffect((()=>{!async function(){const e=await a.db.listCollectionsWithSearch(x);T(e)}()}),[x]),u.useEffect((()=>{!async function(){const e=await a.db.listServers(P);C(e)}()}),[P]),u.useEffect((()=>{!async function(){const e=await a.db.listEndpoints(i.serverId,B);k(e)}()}),[i.serverId,B]),u.useEffect((()=>{if(i.endpoint&&!t){const e=O.find((e=>e.endpoint===i.endpoint)).request,t=JSON.parse(e);s.current.jsonEditor.set(t)}}),[i.endpoint]);return u.createElement(E,{show:e,size:"xs",onHide:r,size:"md",overflow:!1},u.createElement(E.Header,{closeButton:!1},u.createElement(E.Title,null,t?"Edit":"Create"," Preset")),u.createElement(E.Body,null,u.createElement(h,{ref:n,fluid:!0,model:H,formValue:i,onChange:c},u.createElement(y,null,u.createElement(f,null,"Name"),u.createElement(v,{name:"name",accepter:g})),u.createElement(y,null,u.createElement(f,null,"Collection"),u.createElement(v,{name:"collectionId",accepter:R,block:!0,onSearch:A,data:null==j?void 0:j.map((({name:e,id:t})=>({label:e,value:t})))}),u.createElement(_,null,"Currently only support single layer grouping, nested is not supported.")),u.createElement(y,null,u.createElement(f,null,"Server"),u.createElement(v,{name:"serverId",accepter:R,block:!0,onSearch:L,data:null==S?void 0:S.map((({name:e,id:t,connection:r})=>({label:`${e} ( ${r} )`,value:t})))})),u.createElement(y,null,u.createElement(f,null,"Endpoint"),u.createElement(v,{name:"endpoint",accepter:R,block:!0,onSearch:V,data:null==O?void 0:O.map((({endpoint:e})=>({label:e,value:e})))})),u.createElement(y,null,u.createElement(f,null,"Request"),u.createElement(q,{ref:s,htmlElementProps:{style:{height:500}},mode:"code",theme:a.view.getAceTheme(a.storage.getTheme()),ace:D,value:{}}))),d&&u.createElement(w,{type:"error",showIcon:!0,description:d.message})),u.createElement(E.Footer,{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},o?u.createElement(b,{style:{marginRight:10},content:(t?"Updating":"Creating")+" ..."}):u.createElement(I,{appearance:"primary",onClick:async()=>{const{hasError:e}=await n.current.checkAsync();if(!e){m(void 0),l(!0);try{const e=s.current.jsonEditor.get();t?await a.db.modifyPresetById(t,i.name,i.collectionId,i.serverId,i.endpoint,e):await a.db.createPreset(i.name,i.collectionId,i.serverId,i.endpoint,e),r()}catch(o){m(o)}finally{l(!1)}}}},"Confirm"),u.createElement(I,{appearance:"subtle",onClick:r},"Cancel")))}function _e({setCurrent:e,setServerId:t,setEndpoint:r}){const n=u.useContext(ce),[s,a]=u.useState(void 0),[o,l]=u.useState(void 0),[i,c]=u.useState(void 0),[d,m]=u.useState(void 0),[p,h]=u.useState(void 0),[y,f]=u.useState(void 0),[v,g]=he(n.db.listCollections),[_,w]=he((e=>d?n.db.listPresetsByCollectionId(e,d):Ee));let b=B;b=B.default;return u.createElement(u.Fragment,null,u.createElement(fe,{open:i,selectedCollectionId:d,onClose:()=>{c(void 0),v.refresh()}}),u.createElement(ge,{open:p,selectedPresetId:y,onClose:()=>{h(void 0),_.refresh()}}),u.createElement(E,{backdrop:!0,show:void 0!==s,onHide:()=>a(void 0),size:"xs"},u.createElement(E.Header,{closeButton:!1},u.createElement(E.Title,null,u.createElement(x,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete collection")),u.createElement(E.Body,null,"Collection once deleted will not be recover anymore. All of the preset under collection will be deleted also. Are you sure want to proceed?"),u.createElement(E.Footer,null,u.createElement(I,{appearance:"primary",onClick:async()=>{L.info("Deleting collection ...");try{await n.db.deleteCollectionById(s),L.success("Delete collection successfully"),a(void 0),v.refresh()}catch(e){L.error("Error when deleting collection: ",e.message)}}},"Ok"),u.createElement(I,{onClick:()=>a(void 0),appearance:"subtle"},"Cancel"))),u.createElement(E,{backdrop:!0,show:void 0!==o,onHide:()=>l(void 0),size:"xs"},u.createElement(E.Header,{closeButton:!1},u.createElement(E.Title,null,u.createElement(x,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete preset")),u.createElement(E.Body,null,"Preset once deleted will not be recover anymore. Are you sure want to proceed?"),u.createElement(E.Footer,null,u.createElement(I,{appearance:"primary",onClick:async()=>{L.info("Deleting preset ...");try{await n.db.deletePresetById(o),L.success("Delete preset successfully"),l(void 0),_.refresh()}catch(e){L.error("Error when deleting preset: ",e.message)}}},"Ok"),u.createElement(I,{onClick:()=>l(void 0),appearance:"subtle"},"Cancel"))),u.createElement(I,{appearance:"primary",onClick:()=>{c(!0),m(void 0)}},u.createElement(x,{icon:"plus"})," Create Collection"),u.createElement(I,{style:{marginLeft:15},appearance:"primary",onClick:()=>{h(!0),f(void 0)}},u.createElement(x,{icon:"plus"})," Create Preset"),u.createElement("div",{style:{marginTop:10,marginBottom:10}},(null==g?void 0:g.length)>0?u.createElement(b,{onLastItemVisible:null==v?void 0:v.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:g.map((e=>u.createElement("div",{key:e.id,style:{margin:10}},u.createElement(V,{style:d===e.id?{border:"1px solid #4BB543"}:{},className:"folder-panel",onClick:()=>(e=>{m(e.id),_.refresh()})(e),bordered:!0},u.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"baseline"}},d===e.id?u.createElement(x,{icon:"folder-open"}):u.createElement(x,{icon:"folder"}),u.createElement("p",{style:{marginLeft:10}},e.name," ",e.tag&&u.createElement(H,{style:{marginLeft:5}},e.tag)),u.createElement(N,{trigger:"click",placement:"bottom",speaker:u.createElement(z,{full:!0},u.createElement(F.Menu,null,u.createElement(F.Item,{icon:u.createElement(x,{icon:"edit"}),onSelect:()=>(e=>{c(!0),m(e.id)})(e)},"Edit"),u.createElement(F.Item,{icon:u.createElement(x,{icon:"trash"}),onSelect:()=>a(e.id)},"Delete")))},u.createElement(x,{style:{marginLeft:15},icon:"ellipsis-h"})))))))}):u.createElement("h4",{style:{textAlign:"center"}},"You don't have any collection yet. Create your first collection now!")),d&&((null==w?void 0:w.length)>0?u.createElement(b,{onLastItemVisible:null==_?void 0:_.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:w.map((s=>u.createElement("div",{key:s.id,style:{margin:10}},u.createElement(V,{className:"preset-panel",onClick:()=>(s=>{e("preset"),t(s.serverId),r(s.endpoint),n.view.setRequestJSON(s.request),n.view.setResponseJSON({})})(s),bordered:!0},u.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},u.createElement("p",{style:{marginLeft:5}},"( ",s.endpoint," ) ",s.name),u.createElement(N,{trigger:"click",placement:"bottom",speaker:u.createElement(z,{full:!0},u.createElement(F.Menu,null,u.createElement(F.Item,{icon:u.createElement(x,{icon:"edit"}),onSelect:()=>(e=>{h(!0),f(e.id)})(s)},"Edit"),u.createElement(F.Item,{icon:u.createElement(x,{icon:"trash"}),onSelect:()=>l(s.id)},"Delete")))},u.createElement(x,{style:{marginLeft:15},icon:"ellipsis-h"})))))))}):u.createElement("h4",{style:{textAlign:"center"}},"You don't have any preset yet. Create your first preset now!")))}function we({setCurrent:e,setServerId:t,setEndpoint:r}){const n=u.useContext(ce),[s,a]=u.useState(void 0),[o,l]=he(n.db.listHistories);u.useEffect((()=>{n.view.historyController=o}),[o]);const i=()=>{a(void 0)};let c=B;return c=B.default,u.createElement(u.Fragment,null,(null==l?void 0:l.length)>0?u.createElement(c,{onLastItemVisible:null==o?void 0:o.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:l.map((s=>u.createElement("div",{key:s.id,style:{margin:10}},u.createElement(V,{bordered:!0,className:"history-panel",onClick:()=>(s=>{e("history"),t(s.serverId),r(s.endpoint),n.view.setRequestJSON(s.request),n.view.setResponseJSON(s.response)})(s)},u.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},s.isError?u.createElement(H,{color:"red"},"ERROR"):u.createElement(H,{color:"green"},"SUCCESS"),u.createElement("p",{style:{marginLeft:5}},"( ",s.endpoint," ) ",s.connection),u.createElement(M,{style:{marginLeft:5},appearance:"subtle",icon:u.createElement(x,{icon:"trash"}),onClick:()=>a(s.id)}))))))}):u.createElement("h4",{style:{textAlign:"center"}},"You don't have any history yet. Start with your first request now!"),u.createElement(E,{backdrop:!0,show:void 0!==s,onHide:i,size:"xs"},u.createElement(E.Header,{closeButton:!1},u.createElement(E.Title,null,u.createElement(x,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete history")),u.createElement(E.Body,null,"History once deleted will not be recover anymore. Are you sure want to proceed?"),u.createElement(E.Footer,null,u.createElement(I,{appearance:"primary",onClick:async()=>{L.info("Deleting history ...");try{await n.db.deleteHistoryById(s),i(),L.success("Delete history successfully"),o.refresh()}catch(e){L.error("Error when deleting history: ",e.message)}}},"Ok"),u.createElement(I,{onClick:i,appearance:"subtle"},"Cancel"))))}function be(){const e=u.useContext(ce),[t,r]=u.useState(!1),[n,s]=[u.useRef(),u.useRef()],[a,o]=u.useState("history"),[l,i]=u.useState("vscode-webview"===(null==window?void 0:window.mode)?window.editorTheme:e.storage.getTheme()),[c,d]=u.useState("vscode-webview"===(null==window?void 0:window.mode)?window.appTheme:e.storage.getAppTheme()),[m,p]=u.useState(),[E,v]=u.useState(""),[g,_]=u.useState(),[T,O]=u.useState(),[k,A]=u.useState(!1),[P,L]=u.useState(!1),[B,H]=u.useState(void 0),[N,z]=u.useState("normal");let F=null;const U=J.useLiveQuery((()=>e.db.listServers(E)),[t,E]),W=J.useLiveQuery((()=>e.db.listEndpoints(m,T)),[m,T,k]);u.useEffect((()=>{if(s.current.jsonEditor.aceEditor.setOptions({readOnly:!0}),e.view.request=n.current,e.view.response=s.current,"vscode-webview"===(null==window?void 0:window.mode)){const t=JSON.parse(window.servers);t.length>0&&t.forEach((async t=>{let r=[];try{r=await e.api.reloadServerEndpoints(t.connection,t.password)}catch(n){r=[]}await e.db.createServer(ne(),t.name,t.connection,t.password,r)}))}}),[]),u.useEffect((()=>{g&&"normal"===N&&(e.view.setRequestJSON(W.find((e=>e.endpoint===g)).request),e.view.setResponseJSON({}))}),[g]),u.useEffect((()=>{l&&function(e){switch(e){case"./assets/themes/ambiance.js":return K((()=>__import__("./ambiance.6d1c838a.js")),void 0);case"./assets/themes/chaos.js":return K((()=>__import__("./chaos.7c35c85d.js")),void 0);case"./assets/themes/chrome.js":return K((()=>__import__("./chrome.65816def.js")),void 0);case"./assets/themes/clouds.js":return K((()=>__import__("./clouds.bf20920b.js")),void 0);case"./assets/themes/clouds_midnight.js":return K((()=>__import__("./clouds_midnight.35285348.js")),void 0);case"./assets/themes/cobalt.js":return K((()=>__import__("./cobalt.b9391c17.js")),void 0);case"./assets/themes/crimson_editor.js":return K((()=>__import__("./crimson_editor.bc6ede7f.js")),void 0);case"./assets/themes/dawn.js":return K((()=>__import__("./dawn.441103e3.js")),void 0);case"./assets/themes/dracula.js":return K((()=>__import__("./dracula.02a1d846.js")),void 0);case"./assets/themes/dreamweaver.js":return K((()=>__import__("./dreamweaver.e3007ee8.js")),void 0);case"./assets/themes/eclipse.js":return K((()=>__import__("./eclipse.c372d816.js")),void 0);case"./assets/themes/github.js":return K((()=>__import__("./github.6a738693.js")),void 0);case"./assets/themes/gob.js":return K((()=>__import__("./gob.87c162c5.js")),void 0);case"./assets/themes/gruvbox.js":return K((()=>__import__("./gruvbox.c4332e76.js")),void 0);case"./assets/themes/idle_fingers.js":return K((()=>__import__("./idle_fingers.678e6b5e.js")),void 0);case"./assets/themes/iplastic.js":return K((()=>__import__("./iplastic.aede0060.js")),void 0);case"./assets/themes/katzenmilch.js":return K((()=>__import__("./katzenmilch.14a8fefc.js")),void 0);case"./assets/themes/kr_theme.js":return K((()=>__import__("./kr_theme.eebc6cfb.js")),void 0);case"./assets/themes/kuroir.js":return K((()=>__import__("./kuroir.87077666.js")),void 0);case"./assets/themes/merbivore.js":return K((()=>__import__("./merbivore.e4c42952.js")),void 0);case"./assets/themes/merbivore_soft.js":return K((()=>__import__("./merbivore_soft.cb0732f8.js")),void 0);case"./assets/themes/monokai.js":return K((()=>__import__("./monokai.a3f90f7f.js")),void 0);case"./assets/themes/mono_industrial.js":return K((()=>__import__("./mono_industrial.7d9a7dd9.js")),void 0);case"./assets/themes/pastel_on_dark.js":return K((()=>__import__("./pastel_on_dark.6fd48c0b.js")),void 0);case"./assets/themes/solarized_dark.js":return K((()=>__import__("./solarized_dark.a87c2756.js")),void 0);case"./assets/themes/solarized_light.js":return K((()=>__import__("./solarized_light.319130bd.js")),void 0);case"./assets/themes/sqlserver.js":return K((()=>__import__("./sqlserver.32b72c7b.js")),void 0);case"./assets/themes/terminal.js":return K((()=>__import__("./terminal.b4b9816e.js")),void 0);case"./assets/themes/textmate.js":return K((()=>__import__("./textmate.d353b46e.js")),void 0);case"./assets/themes/tomorrow.js":return K((()=>__import__("./tomorrow.30671ec6.js")),void 0);case"./assets/themes/tomorrow_night.js":return K((()=>__import__("./tomorrow_night.3029818c.js")),void 0);case"./assets/themes/tomorrow_night_blue.js":return K((()=>__import__("./tomorrow_night_blue.5fe4aef7.js")),void 0);case"./assets/themes/tomorrow_night_bright.js":return K((()=>__import__("./tomorrow_night_bright.b6e48479.js")),void 0);case"./assets/themes/tomorrow_night_eighties.js":return K((()=>__import__("./tomorrow_night_eighties.cb8f15e4.js")),void 0);case"./assets/themes/twilight.js":return K((()=>__import__("./twilight.5d53b599.js")),void 0);case"./assets/themes/vibrant_ink.js":return K((()=>__import__("./vibrant_ink.566c7ff1.js")),void 0);case"./assets/themes/xcode.js":return K((()=>__import__("./xcode.76ad88bd.js")),void 0);default:return Promise.reject(new Error("Unknown variable dynamic import: "+e))}}(`./assets/themes/${l}.js`).then((()=>{e.view.setRequestTheme(l),e.view.setResponseTheme(l),e.storage.setTheme(l)}))}),[l]),u.useEffect((()=>{F&&F.parentNode.removeChild(F),F=document.createElement("link"),F.rel="stylesheet","vscode-webview"===(null==window?void 0:window.mode)?F.href=`${window.base}/${c}.css`:F.href=`./${c}.css`,F.dataset.theme=c,document.head.appendChild(F),e.storage.setAppTheme(c)}),[c]);const G={setting:u.createElement(pe,{theme:l,setTheme:i,appTheme:c,setAppTheme:d}),preset:u.createElement(_e,{setCurrent:z,setServerId:p,setEndpoint:_}),history:u.createElement(we,{setCurrent:z,setServerId:p,setEndpoint:_,setError:H})};return u.createElement("div",null,u.createElement(me,{selectedServerId:m,open:t,onClose:()=>r(!1)}),u.createElement(V,{style:{marginLeft:40,marginRight:40}},u.createElement($,{appearance:"tabs",activeKey:a,onSelect:o},u.createElement($.Item,{eventKey:"history",icon:u.createElement(x,{icon:"history"})},"History"),u.createElement($.Item,{eventKey:"preset",icon:u.createElement(x,{icon:"list"})},"Collection"),u.createElement($.Item,{eventKey:"setting",icon:u.createElement(x,{icon:"setting"})},"Setting")),u.createElement(V,null,G[a])),u.createElement(S,{fluid:!0,style:{marginTop:"calc(3vh)",marginBottom:"calc(3vh)",marginLeft:"20px",marginRight:"20px",height:"calc(94vh)"}},u.createElement(C,{style:{height:"100%"}},u.createElement(j,{style:{height:"100%"},xs:10,xsPush:1},u.createElement(C,{style:{display:"flex",height:"100%",flexDirection:"column"}},u.createElement(h,{fluid:!0},u.createElement(y,null,u.createElement(f,null,"Server"),u.createElement("div",{style:{display:"flex"}},u.createElement(R,{style:{flex:1},block:!0,placeholder:"Please select server ...",value:m,onChange:p,onSearch:v,data:null==U?void 0:U.map((({name:e,id:t})=>({label:e,value:t})))}),u.createElement(M,{appearances:"primary",style:{marginLeft:10},icon:u.createElement(x,{icon:m?"edit2":"plus"}),onClick:()=>r(!0)}))),u.createElement(y,null,u.createElement(f,null,"Endpoint"),u.createElement("div",{style:{display:"flex"}},u.createElement(R,{style:{flex:1},block:!0,placeholder:"Please select endpoint ...",value:g,onChange:e=>{z("normal"),_(e)},onSearch:O,data:null==W?void 0:W.map((({endpoint:e})=>({label:e,value:e})))}),u.createElement(M,{appearance:"primary",style:{marginLeft:10},icon:u.createElement(x,{icon:"reload"}),onClick:async()=>{if(m){H(void 0);try{const t=await e.db.getServerById(m),r=await e.api.reloadServerEndpoints(t.connection,t.password);await e.db.modifyServerEndpointsById(m,r),A(!k)}catch(t){H(t)}}}})))),u.createElement(q,{htmlElementProps:{style:{flex:1,marginBottom:20,marginTop:20}},ref:n,mode:"code",ace:D,value:{}}),P?u.createElement(b,{style:{textAlign:"center"},content:"Sending Request ..."}):u.createElement(I,{style:{width:"100%"},appearance:"primary",onClick:async()=>{if(!m||!g)return;L(!0),H(void 0);const t=e.view.getRequestJSON(),r=await e.db.getServerById(m);try{const n=await e.api.sendRequest(r.connection,g,t,r.password);await e.db.createHistory(m,g,t,n,!1),e.view.setResponseJSON(n)}catch(n){H(n),await e.db.createHistory(m,g,t,n.message,!0)}finally{L(!1),e.view.historyController.refresh()}}},u.createElement(x,{icon:"send"})," Send Request"))),u.createElement(j,{xs:10,xsPush:3,style:{display:"flex",flexDirection:"column",height:"100%"}},B&&u.createElement(w,{style:{marginBottom:20},type:"error",showIcon:!0,description:B.message}),u.createElement(q,{htmlElementProps:{style:{flex:1}},ref:s,mode:"code",ace:D,value:{}})))))}U.render(u.createElement(ce.Provider,{value:ie},u.createElement(be,null)),document.getElementById("root"));
