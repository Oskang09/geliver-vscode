var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,n=(t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,a=(e,a)=>{for(var o in a||(a={}))t.call(a,o)&&n(e,o,a[o]);if(r)for(var o of r(a))s.call(a,o)&&n(e,o,a[o]);return e},o=(e,t,r)=>(n(e,"symbol"!=typeof t?t+"":t,r),r);import{h as l,D as i,e as c,i as m,a as d,G as u,R as p,C as E,S as h,b as y,c as _,H as f,U as v,B as g,I as w,d as b,E as I,P as C,M as j,A as S,f as R,F as O,g as k,j as x,k as T,l as A,L as P,m as L,n as D,o as q,p as B,T as V,W as N,q as H,r as M,s as z,t as J,u as $,v as F}from"./vendor.826244c9.js";let U;!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(r){const s=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((r,a)=>{const o=new URL(e,s);if(self[t].moduleMap[o])return r(self[t].moduleMap[o]);const l=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){a(new Error(`Failed to import: ${e}`)),n(i)},onload(){r(self[t].moduleMap[o]),n(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/geliver/assets/");const W={},K=function(e,t){if(!t)return e();if(void 0===U){const e=document.createElement("link").relList;U=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in W)return;W[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":U,t||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),t?new Promise(((e,t)=>{s.addEventListener("load",e),s.addEventListener("error",t)})):void 0}))).then((()=>e()))};function Y(){return l().format("x")+function(e){const t=[];for(let r=0;r<e;r++)t.push(Math.floor(10*Math.random()).toString());return t.join("")}(4)}let Q=new i("geliver",{addons:[]});Q.version(1).stores({histories:"&id, serverId, endpoint, createdAt",servers:"&id, name, endpoints, updatedAt",collections:"&id, name, tag, updatedAt",presets:"&id, name, collectionId, serverId, endpoint, updatedAt"});const G=async(e,t="",r="id",s=!0,n=10)=>{t&&(e=e.where(r),e=s?e.belowOrEqual(t):e.aboveOrEqual(t));let a=e.limit(n+1);s&&(a=a.reverse());const o=await a.sortBy(r);let l;return o.length===n+1&&(l=o.pop()[r]),[o,l]};class X{constructor(e){o(this,"exportDatabase",(async(e=(()=>{}))=>await c(Q,{progressCallback:e}))),o(this,"importDatabase",(async(e,t=(()=>{}))=>{await Q.delete(),await Q.open(),await m(Q,e,{progressCallback:t})})),o(this,"checkServerIdValid",(async e=>void 0===await Q.servers.where("id").equals(e).first())),o(this,"getCollectionById",(async e=>Q.collections.where("id").equals(e).first())),o(this,"getPresetById",(async e=>Q.presets.where("id").equals(e).first())),o(this,"getServerById",(async e=>Q.servers.where("id").equals(e).first())),o(this,"getServerNameById",(async e=>{const t=await Q.servers.where("id").equals(e).first();return null==t?void 0:t.name})),o(this,"listServers",(async e=>{let t=Q.servers;return e&&(t=t.where("name").startsWithAnyOf(e)),t.limit(50).toArray()})),o(this,"listCollectionsWithSearch",(async e=>{let t=Q.collections;return e&&(t=t.where("name").startsWithAnyOf(e)),t.limit(50).toArray()})),o(this,"listEndpoints",(async(e,t)=>{if(!e)return[];const r=await Q.servers.where("id").equals(e).first();let s=(null==r?void 0:r.endpoints)||[];return t&&(s=s.filter((e=>e.endpoint.toLowerCase().includes(t.toLowerCase())))),s})),o(this,"listCollections",(async e=>G(Q.collections,e,"name",!1,8))),o(this,"listPresetsByCollectionId",(async(e,t)=>G(Q.presets.where("collectionId").equals(t),e,"name",!1,8))),o(this,"listHistories",(async e=>{const t={},r=async e=>(t[e]||(t[e]=this.getServerNameById(e)),t[e]),[s,n]=await G(Q.histories,e,"createdAt",!0,8),a=Promise.all(s.map((async e=>Object.assign(e,{name:await r(e.serverId)}))));return[await a,n]})),o(this,"modifyServerEndpointsById",(async(e,t)=>{await Q.servers.where("id").equals(e).modify({endpoints:t,updatedAt:l.utc().valueOf()})})),o(this,"modifyServerById",(async(e,t,r,s,n)=>{await Q.servers.where("id").equals(e).modify({name:t,connection:r,password:s,endpoints:n,updatedAt:l.utc().valueOf()})})),o(this,"modifyCollectionById",(async(e,t,r)=>{await Q.collections.where("id").equals(e).modify({name:t,tag:r,updatedAt:l.utc().valueOf()})})),o(this,"modifyPresetById",(async(e,t,r,s,n)=>{await Q.presets.where("id").equals(id).modify({name:e,collectionId:t,serverId:r,endpoint:s,request:n,updatedAt:l.utc().valueOf()})})),o(this,"createCollection",(async(e,t)=>{await Q.collections.put({id:Y(),updatedAt:l.utc().valueOf(),name:e,tag:t})})),o(this,"createPreset",(async(e,t,r,s,n)=>{await Q.presets.put({id:Y(),updatedAt:l.utc().valueOf(),name:e,collectionId:t,serverId:r,endpoint:s,request:n})})),o(this,"createServer",(async(e,t,r)=>{await Q.servers.put({id:e,name:t,endpoints:r,updatedAt:l.utc().valueOf()})})),o(this,"createHistory",(async(e,t,r,s,n)=>{await Q.histories.put({id:Y(),serverId:e,endpoint:t,request:r,response:s,isError:n,createdAt:l.utc().valueOf()})})),o(this,"upsertPreset",(async(e,t,r,s,n)=>{e||(e=Y()),await Q.presets.put({id:e,name:t,serverId:r,endpoint:s,request:n,updatedAt:l.utc().valueOf()})})),o(this,"deletePresetById",(async e=>{await Q.presets.where("id").equals(e).delete()})),o(this,"deleteCollectionById",(async e=>{await Q.collections.where("id").equals(e).delete()})),o(this,"deleteHistoryById",(async e=>{await Q.histories.where("id").equals(e).delete()})),o(this,"clearHistory",(async()=>{await Q.histories.clear()})),this.root=e}}class Z{constructor(){o(this,"getRequestJSON",(()=>this.request.jsonEditor.get())),o(this,"setRequestTheme",(e=>{this.request.jsonEditor.aceEditor.setTheme(`ace/theme/${e}`)})),o(this,"setResponseTheme",(e=>{this.response.jsonEditor.aceEditor.setTheme(`ace/theme/${e}`)})),o(this,"getAceTheme",(e=>`ace/theme/${e}`)),o(this,"setResponseJSON",(e=>{try{const t=JSON.parse(e);this.response.jsonEditor.set(t)}catch(t){this.response.jsonEditor.set(e)}})),o(this,"setRequestJSON",(e=>{try{const t=JSON.parse(e);this.request.jsonEditor.set(t)}catch(t){this.request.jsonEditor.set(e)}})),this.request=null,this.response=null,this.historyController={}}}const ee=new class{constructor(){this.vscode=acquireVsCodeApi(),this.view=new Z(this),this.db=new X(this)}},te=d.createContext(ee),re=["ambiance","chaos","chrome","clouds","clouds_midnight","cobalt","crimson_editor","dawn","dracula","dreamweaver","eclipse","github","gob","gruvbox","idle_fingers","iplastic","katzenmilch","kr_theme","kuroir","merbivore","merbivore_soft","monokai","mono_industrial","pastel_on_dark","solarized_dark","solarized_light","sqlserver","terminal","textmate","tomorrow","tomorrow_night","tomorrow_night_blue","tomorrow_night_bright","tomorrow_night_eighties","twilight","vibrant_ink","xcode"];function se({theme:e,setTheme:t,appTheme:r,setAppTheme:s}){const n=d.useContext(te),[o,l]=d.useState(!1),[i,c]=d.useState(!1),[m,R]=d.useState(void 0),O=()=>{l(void 0)};return d.createElement(u,{fluid:!0},d.createElement(p,{style:{display:"flex",alignItems:"center"}},d.createElement(E,{xs:2},d.createElement("p",null,"Editor Theme")),d.createElement(E,{xs:6},d.createElement(h,{block:!0,value:e,onChange:t,data:re.map((e=>({label:e,value:e})))}))),d.createElement(p,{style:{display:"flex",alignItems:"center",marginTop:15}},d.createElement(E,{xs:2},d.createElement("p",null,"App Theme")),d.createElement(E,{xs:22},d.createElement(y,{inline:!0,value:r,onChange:s},d.createElement(_,{value:"light"},"â˜€ï¸ Light"),d.createElement(_,{value:"dark"},"ðŸŒ™ Dark")),d.createElement(f,null,"Sometimes may not working, refresh should take the changes."))),d.createElement(p,{style:{display:"flex",alignItems:"center",marginTop:15}},d.createElement(E,{xs:2},d.createElement("p",null,"Actions")),d.createElement(E,{xs:22,style:{display:"flex",flexDirection:"row"}},d.createElement(v,{fileListVisible:!1,autoUpload:!1,action:"",onChange:async e=>{c("import");try{n.db.importDatabase(e[0].blobFile,(e=>R(a({},e))))}catch(t){R({error:t,done:!0})}}},d.createElement(g,null,d.createElement(w,{icon:"import"})," Import Data")),d.createElement(g,{style:{marginLeft:10},appearance:"primary",onClick:async()=>{c("export");try{const e=await n.db.exportDatabase((e=>R(a({},e))));b(e,"geliver.json","application/json")}catch(e){R({error:e,done:!0})}}},d.createElement(w,{icon:"export"})," Export Data"),d.createElement(g,{style:{marginLeft:10},appearance:"primary",onClick:()=>l(!0)},d.createElement(w,{icon:"trash"})," Clear History"))),d.createElement(I,{show:void 0!==m,overflow:!1,size:"xs"},d.createElement(I.Header,{closeButton:!1},d.createElement(I.Title,null,d.createElement(w,{icon:"export"===i?"export":"import",style:{marginRight:10}}),"export"===i?"Exporting":"Importing"," Data")),d.createElement(I.Body,{style:{display:"flex",justifyContent:"center",flexDirection:"row"}},d.createElement(C.Circle,{style:{width:120},percent:Math.floor((null==m?void 0:m.completedRows)/(null==m?void 0:m.totalRows)*100),status:(null==m?void 0:m.done)?m.error?"fail":"success":"active"}),d.createElement("dl",{style:{marginLeft:30}},d.createElement("dt",null,"Num Of Tables:"),d.createElement("dd",null,null==m?void 0:m.totalTables),d.createElement("dt",null,"Num Of Rows:"),d.createElement("dd",null,null==m?void 0:m.completedRows," / ",null==m?void 0:m.totalRows))),(null==m?void 0:m.error)&&d.createElement(j,{type:"error",title:"Import Error",description:null==m?void 0:m.error.message}),(null==m?void 0:m.done)&&d.createElement(I.Footer,null,d.createElement(g,{appearance:"primary",onClick:()=>{R(void 0)}},"Close"))),d.createElement(I,{backdrop:!0,show:o,onHide:O,size:"xs"},d.createElement(I.Header,{closeButton:!1},d.createElement(I.Title,null,d.createElement(w,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Clear histories")),d.createElement(I.Body,null,"Histories once cleared will not be recover anymore. Are you sure want to proceed?"),d.createElement(I.Footer,null,d.createElement(g,{appearance:"primary",onClick:async()=>{S.info("Clearing histories ...");try{await n.db.clearHistory(),O(),S.success("Clear histories successfully"),n.view.historyController.refresh()}catch(e){S.error("Error when clearing histories: ",e.message)}}},"Ok"),d.createElement(g,{onClick:O,appearance:"subtle"},"Cancel"))))}const ne=Promise.resolve([[],void 0]);function ae(e){const[t,r]=d.useState(!1),[s,n]=d.useState(!1),[a,o]=d.useState(!1),[l,i]=d.useState(),[c,m]=d.useState([]);d.useEffect((()=>{a||s||(n(!0),async function(){const[t,r]=await e(l);m(l?[...c,...t]:[...t]),i(r),r||o(!0),n(!1)}())}),[t]);return[{loading:s,isEnd:a,refresh:()=>{s||(i(void 0),o(!1),r(!t))},loadMore:()=>{a||s||r(!t)}},c]}const{StringType:oe}=R.Types;function le({open:e,selectedCollectionId:t,onClose:r}){const s=d.useRef(),n=d.useContext(te),[a,o]=d.useState(!1),[l,i]=d.useState({}),[c,m]=d.useState(void 0),u=R.Model({name:oe().isRequired("Name is required")});d.useEffect((()=>{i({}),t&&async function(){const e=await n.db.getCollectionById(t);i({name:e.name,tag:e.tag})}()}),[t]);return d.createElement(I,{show:e,size:"xs",onHide:r},d.createElement(I.Header,{closeButton:!1},d.createElement(I.Title,null,t?"Edit":"Create"," Collection")),d.createElement(I.Body,null,d.createElement(O,{ref:s,fluid:!0,model:u,formValue:l,onChange:i},d.createElement(k,null,d.createElement(x,null,"Name"),d.createElement(T,{name:"name",accepter:A})),d.createElement(k,null,d.createElement(x,null,"Tag"),d.createElement(T,{name:"tag",accepter:A}),d.createElement(f,null,"Tag is just for display purpse, usually for specify development, staging or production. You can use as ur own recognize purpose."))),c&&d.createElement(j,{type:"error",showIcon:!0,description:c.message})),d.createElement(I.Footer,{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},a?d.createElement(P,{style:{marginRight:10},content:(t?"Updating":"Creating")+" ..."}):d.createElement(g,{appearance:"primary",onClick:async()=>{const{hasError:e}=await s.current.checkAsync();if(!e){m(void 0),o(!0);try{t?await n.db.modifyCollectionById(t,l.name,l.tag):await n.db.createCollection(l.name,l.tag),r()}catch(a){m(a)}finally{o(!1)}}}},"Confirm"),d.createElement(g,{appearance:"subtle",onClick:r},"Cancel")))}const{StringType:ie}=R.Types;function ce({theme:e,open:t,selectedPresetId:r,onClose:s}){const n=d.useRef(),a=d.useRef(),o=d.useContext(te),[l,i]=d.useState(!1),[c,m]=d.useState({}),[u,p]=d.useState(void 0),[E,y]=d.useState([]),[_,v]=d.useState([]),[w,b]=d.useState([]),[C,S]=d.useState(),[q,B]=d.useState(),[V,N]=d.useState(),H=R.Model({name:ie().isRequired("Name is required"),collectionId:ie().isRequired("Collection is required"),serverId:ie().isRequired("Server is required"),endpoint:ie().isRequired("Endpoint is required")});d.useEffect((()=>{m({}),r&&async function(){const e=await o.db.getPresetById(r);a.current.jsonEditor.set(e.request),m({name:e.name,collectionId:e.collectionId,serverId:e.serverId,endpoint:e.endpoint,request:e.request})}()}),[r]),d.useEffect((()=>{!async function(){const e=await o.db.listCollectionsWithSearch(C);v(e)}()}),[C]),d.useEffect((()=>{!async function(){const e=await o.db.listServers(q);y(e)}()}),[q]),d.useEffect((()=>{!async function(){const e=await o.db.listEndpoints(c.serverId,V);b(e)}()}),[c.serverId,V]),d.useEffect((()=>{if(c.endpoint&&!r){const e=w.find((e=>e.endpoint===c.endpoint)).request,t=JSON.parse(e);a.current.jsonEditor.set(t)}}),[c.endpoint]);return d.createElement(I,{show:t,size:"xs",onHide:s,size:"md",overflow:!1},d.createElement(I.Header,{closeButton:!1},d.createElement(I.Title,null,r?"Edit":"Create"," Preset")),d.createElement(I.Body,null,d.createElement(O,{ref:n,fluid:!0,model:H,formValue:c,onChange:m},d.createElement(k,null,d.createElement(x,null,"Name"),d.createElement(T,{name:"name",accepter:A})),d.createElement(k,null,d.createElement(x,null,"Collection"),d.createElement(T,{name:"collectionId",accepter:h,block:!0,onSearch:S,data:null==_?void 0:_.map((({name:e,id:t})=>({label:e,value:t})))}),d.createElement(f,null,"Currently only support single layer grouping, nested is not supported.")),d.createElement(k,null,d.createElement(x,null,"Server"),d.createElement(T,{name:"serverId",accepter:h,block:!0,onSearch:B,data:null==E?void 0:E.map((({name:e,id:t,connection:r})=>({label:`${e} ( ${r} )`,value:t})))})),d.createElement(k,null,d.createElement(x,null,"Endpoint"),d.createElement(T,{name:"endpoint",accepter:h,block:!0,onSearch:N,data:null==w?void 0:w.map((({endpoint:e})=>({label:e,value:e})))})),d.createElement(k,null,d.createElement(x,null,"Request"),d.createElement(L,{ref:a,htmlElementProps:{style:{height:500}},mode:"code",theme:o.view.getAceTheme(e),ace:D,value:{}}))),u&&d.createElement(j,{type:"error",showIcon:!0,description:u.message})),d.createElement(I.Footer,{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},l?d.createElement(P,{style:{marginRight:10},content:(r?"Updating":"Creating")+" ..."}):d.createElement(g,{appearance:"primary",onClick:async()=>{const{hasError:e}=await n.current.checkAsync();if(!e){p(void 0),i(!0);try{const e=a.current.jsonEditor.get();r?await o.db.modifyPresetById(r,c.name,c.collectionId,c.serverId,c.endpoint,e):await o.db.createPreset(c.name,c.collectionId,c.serverId,c.endpoint,e),s()}catch(t){p(t)}finally{i(!1)}}}},"Confirm"),d.createElement(g,{appearance:"subtle",onClick:s},"Cancel")))}function me({theme:e,setCurrent:t,setServerId:r,setEndpoint:s}){const n=d.useContext(te),[a,o]=d.useState(void 0),[l,i]=d.useState(void 0),[c,m]=d.useState(void 0),[u,p]=d.useState(void 0),[E,h]=d.useState(void 0),[y,_]=d.useState(void 0),[f,v]=ae(n.db.listCollections),[b,C]=ae((e=>u?n.db.listPresetsByCollectionId(e,u):ne));let j=q;j=q.default;return d.createElement(d.Fragment,null,d.createElement(le,{open:c,selectedCollectionId:u,onClose:()=>{m(void 0),f.refresh()}}),d.createElement(ce,{theme:e,open:E,selectedPresetId:y,onClose:()=>{h(void 0),b.refresh()}}),d.createElement(I,{backdrop:!0,show:void 0!==a,onHide:()=>o(void 0),size:"xs"},d.createElement(I.Header,{closeButton:!1},d.createElement(I.Title,null,d.createElement(w,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete collection")),d.createElement(I.Body,null,"Collection once deleted will not be recover anymore. All of the preset under collection will be deleted also. Are you sure want to proceed?"),d.createElement(I.Footer,null,d.createElement(g,{appearance:"primary",onClick:async()=>{S.info("Deleting collection ...");try{await n.db.deleteCollectionById(a),S.success("Delete collection successfully"),o(void 0),f.refresh()}catch(e){S.error("Error when deleting collection: ",e.message)}}},"Ok"),d.createElement(g,{onClick:()=>o(void 0),appearance:"subtle"},"Cancel"))),d.createElement(I,{backdrop:!0,show:void 0!==l,onHide:()=>i(void 0),size:"xs"},d.createElement(I.Header,{closeButton:!1},d.createElement(I.Title,null,d.createElement(w,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete preset")),d.createElement(I.Body,null,"Preset once deleted will not be recover anymore. Are you sure want to proceed?"),d.createElement(I.Footer,null,d.createElement(g,{appearance:"primary",onClick:async()=>{S.info("Deleting preset ...");try{await n.db.deletePresetById(l),S.success("Delete preset successfully"),i(void 0),b.refresh()}catch(e){S.error("Error when deleting preset: ",e.message)}}},"Ok"),d.createElement(g,{onClick:()=>i(void 0),appearance:"subtle"},"Cancel"))),d.createElement(g,{appearance:"primary",onClick:()=>{m(!0),p(void 0)}},d.createElement(w,{icon:"plus"})," Create Collection"),d.createElement(g,{style:{marginLeft:15},appearance:"primary",onClick:()=>{h(!0),_(void 0)}},d.createElement(w,{icon:"plus"})," Create Preset"),d.createElement("div",{style:{marginTop:10,marginBottom:10}},(null==v?void 0:v.length)>0?d.createElement(j,{onLastItemVisible:null==f?void 0:f.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:v.map((e=>d.createElement("div",{key:e.id,style:{margin:10}},d.createElement(B,{style:u===e.id?{border:"1px solid #4BB543"}:{},className:"folder-panel",onClick:()=>(e=>{p(e.id),b.refresh()})(e),bordered:!0},d.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"baseline"}},u===e.id?d.createElement(w,{icon:"folder-open"}):d.createElement(w,{icon:"folder"}),d.createElement("p",{style:{marginLeft:10}},e.name," ",e.tag&&d.createElement(V,{style:{marginLeft:5}},e.tag)),d.createElement(N,{trigger:"click",placement:"bottom",speaker:d.createElement(H,{full:!0},d.createElement(M.Menu,null,d.createElement(M.Item,{icon:d.createElement(w,{icon:"edit"}),onSelect:()=>(e=>{m(!0),p(e.id)})(e)},"Edit"),d.createElement(M.Item,{icon:d.createElement(w,{icon:"trash"}),onSelect:()=>o(e.id)},"Delete")))},d.createElement(w,{style:{marginLeft:15},icon:"ellipsis-h"})))))))}):d.createElement("h4",{style:{textAlign:"center"}},"You don't have any collection yet. Create your first collection now!")),u&&((null==C?void 0:C.length)>0?d.createElement(j,{onLastItemVisible:null==b?void 0:b.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:C.map((e=>d.createElement("div",{key:e.id,style:{margin:10}},d.createElement(B,{className:"preset-panel",onClick:()=>(e=>{t("preset"),r(e.serverId),s(e.endpoint),n.view.setRequestJSON(e.request),n.view.setResponseJSON({})})(e),bordered:!0},d.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},d.createElement("p",{style:{marginLeft:5}},"( ",e.endpoint," ) ",e.name),d.createElement(N,{trigger:"click",placement:"bottom",speaker:d.createElement(H,{full:!0},d.createElement(M.Menu,null,d.createElement(M.Item,{icon:d.createElement(w,{icon:"edit"}),onSelect:()=>(e=>{h(!0),_(e.id)})(e)},"Edit"),d.createElement(M.Item,{icon:d.createElement(w,{icon:"trash"}),onSelect:()=>i(e.id)},"Delete")))},d.createElement(w,{style:{marginLeft:15},icon:"ellipsis-h"})))))))}):d.createElement("h4",{style:{textAlign:"center"}},"You don't have any preset yet. Create your first preset now!")))}function de({setCurrent:e,setServerId:t,setEndpoint:r}){const s=d.useContext(te),[n,a]=d.useState(void 0),[o,l]=ae(s.db.listHistories);d.useEffect((()=>{s.view.historyController=o}),[o]);const i=()=>{a(void 0)};let c=q;return c=q.default,d.createElement(d.Fragment,null,(null==l?void 0:l.length)>0?d.createElement(c,{onLastItemVisible:null==o?void 0:o.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:l.map((n=>d.createElement("div",{key:n.id,style:{margin:10}},d.createElement(B,{bordered:!0,className:"history-panel",onClick:()=>(n=>{e("history"),t(n.serverId),r(n.endpoint),s.view.setRequestJSON(n.request),s.view.setResponseJSON(n.response)})(n)},d.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},n.isError?d.createElement(V,{color:"red"},"ERROR"):d.createElement(V,{color:"green"},"SUCCESS"),d.createElement("p",{style:{marginLeft:5}},"( ",n.endpoint," ) ",n.name),d.createElement(z,{style:{marginLeft:5},appearance:"subtle",icon:d.createElement(w,{icon:"trash"}),onClick:()=>a(n.id)}))))))}):d.createElement("h4",{style:{textAlign:"center"}},"You don't have any history yet. Start with your first request now!"),d.createElement(I,{backdrop:!0,show:void 0!==n,onHide:i,size:"xs"},d.createElement(I.Header,{closeButton:!1},d.createElement(I.Title,null,d.createElement(w,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete history")),d.createElement(I.Body,null,"History once deleted will not be recover anymore. Are you sure want to proceed?"),d.createElement(I.Footer,null,d.createElement(g,{appearance:"primary",onClick:async()=>{S.info("Deleting history ...");try{await s.db.deleteHistoryById(n),i(),S.success("Delete history successfully"),o.refresh()}catch(e){S.error("Error when deleting history: ",e.message)}}},"Ok"),d.createElement(g,{onClick:i,appearance:"subtle"},"Cancel"))))}function ue(){const e=d.useContext(te),[t,r]=[d.useRef(),d.useRef()],[s,n]=d.useState("history"),[a,o]=d.useState(window.editorTheme),[l,i]=d.useState(window.appTheme),[c,m]=d.useState(),[y,_]=d.useState(""),[f,v]=d.useState(),[b,I]=d.useState(),[C,S]=d.useState(!1),[R,T]=d.useState(void 0),[A,q]=d.useState("normal");let V=null;const N=J.useLiveQuery((()=>e.db.listServers(y)),[y]),H=J.useLiveQuery((()=>e.db.listEndpoints(c,b)),[c,b]);d.useEffect((()=>{r.current.jsonEditor.aceEditor.setOptions({readOnly:!0}),e.view.request=t.current,e.view.response=r.current;const s=JSON.parse(window.autoload);for(const{service:t,methods:r}of s)e.db.createServer(Y(),t,r)}),[]),d.useEffect((()=>{if(f&&"normal"===A){const t=H.find((e=>e.endpoint===f));e.view.setRequestJSON(t.request),e.view.setResponseJSON(t.response)}}),[f]),d.useEffect((()=>{a&&function(e){switch(e){case"./assets/themes/ambiance.js":return K((()=>__import__("./ambiance.6d1c838a.js")),void 0);case"./assets/themes/chaos.js":return K((()=>__import__("./chaos.7c35c85d.js")),void 0);case"./assets/themes/chrome.js":return K((()=>__import__("./chrome.65816def.js")),void 0);case"./assets/themes/clouds.js":return K((()=>__import__("./clouds.bf20920b.js")),void 0);case"./assets/themes/clouds_midnight.js":return K((()=>__import__("./clouds_midnight.35285348.js")),void 0);case"./assets/themes/cobalt.js":return K((()=>__import__("./cobalt.b9391c17.js")),void 0);case"./assets/themes/crimson_editor.js":return K((()=>__import__("./crimson_editor.bc6ede7f.js")),void 0);case"./assets/themes/dawn.js":return K((()=>__import__("./dawn.441103e3.js")),void 0);case"./assets/themes/dracula.js":return K((()=>__import__("./dracula.02a1d846.js")),void 0);case"./assets/themes/dreamweaver.js":return K((()=>__import__("./dreamweaver.e3007ee8.js")),void 0);case"./assets/themes/eclipse.js":return K((()=>__import__("./eclipse.c372d816.js")),void 0);case"./assets/themes/github.js":return K((()=>__import__("./github.6a738693.js")),void 0);case"./assets/themes/gob.js":return K((()=>__import__("./gob.87c162c5.js")),void 0);case"./assets/themes/gruvbox.js":return K((()=>__import__("./gruvbox.c4332e76.js")),void 0);case"./assets/themes/idle_fingers.js":return K((()=>__import__("./idle_fingers.678e6b5e.js")),void 0);case"./assets/themes/iplastic.js":return K((()=>__import__("./iplastic.aede0060.js")),void 0);case"./assets/themes/katzenmilch.js":return K((()=>__import__("./katzenmilch.14a8fefc.js")),void 0);case"./assets/themes/kr_theme.js":return K((()=>__import__("./kr_theme.eebc6cfb.js")),void 0);case"./assets/themes/kuroir.js":return K((()=>__import__("./kuroir.87077666.js")),void 0);case"./assets/themes/merbivore.js":return K((()=>__import__("./merbivore.e4c42952.js")),void 0);case"./assets/themes/merbivore_soft.js":return K((()=>__import__("./merbivore_soft.cb0732f8.js")),void 0);case"./assets/themes/monokai.js":return K((()=>__import__("./monokai.a3f90f7f.js")),void 0);case"./assets/themes/mono_industrial.js":return K((()=>__import__("./mono_industrial.7d9a7dd9.js")),void 0);case"./assets/themes/pastel_on_dark.js":return K((()=>__import__("./pastel_on_dark.6fd48c0b.js")),void 0);case"./assets/themes/solarized_dark.js":return K((()=>__import__("./solarized_dark.a87c2756.js")),void 0);case"./assets/themes/solarized_light.js":return K((()=>__import__("./solarized_light.319130bd.js")),void 0);case"./assets/themes/sqlserver.js":return K((()=>__import__("./sqlserver.32b72c7b.js")),void 0);case"./assets/themes/terminal.js":return K((()=>__import__("./terminal.b4b9816e.js")),void 0);case"./assets/themes/textmate.js":return K((()=>__import__("./textmate.d353b46e.js")),void 0);case"./assets/themes/tomorrow.js":return K((()=>__import__("./tomorrow.30671ec6.js")),void 0);case"./assets/themes/tomorrow_night.js":return K((()=>__import__("./tomorrow_night.3029818c.js")),void 0);case"./assets/themes/tomorrow_night_blue.js":return K((()=>__import__("./tomorrow_night_blue.5fe4aef7.js")),void 0);case"./assets/themes/tomorrow_night_bright.js":return K((()=>__import__("./tomorrow_night_bright.b6e48479.js")),void 0);case"./assets/themes/tomorrow_night_eighties.js":return K((()=>__import__("./tomorrow_night_eighties.cb8f15e4.js")),void 0);case"./assets/themes/twilight.js":return K((()=>__import__("./twilight.5d53b599.js")),void 0);case"./assets/themes/vibrant_ink.js":return K((()=>__import__("./vibrant_ink.566c7ff1.js")),void 0);case"./assets/themes/xcode.js":return K((()=>__import__("./xcode.76ad88bd.js")),void 0);default:return Promise.reject(new Error("Unknown variable dynamic import: "+e))}}(`./assets/themes/${a}.js`).then((()=>{e.view.setRequestTheme(a),e.view.setResponseTheme(a),e.vscode.postMessage({action:"update.editor-theme",payload:a})}))}),[a]),d.useEffect((()=>{V&&V.parentNode.removeChild(V),V=document.createElement("link"),V.rel="stylesheet",V.href=`${window.base}/${l}.css`,V.dataset.theme=l,document.head.appendChild(V),e.vscode.postMessage({action:"update.app-theme",payload:l})}),[l]);const M={setting:d.createElement(se,{theme:a,setTheme:o,appTheme:l,setAppTheme:i}),preset:d.createElement(me,{theme:a,setCurrent:q,setServerId:m,setEndpoint:v}),history:d.createElement(de,{setCurrent:q,setServerId:m,setEndpoint:v,setError:T})};return d.createElement("div",null,d.createElement(B,{style:{marginLeft:40,marginRight:40}},d.createElement($,{appearance:"tabs",activeKey:s,onSelect:n},d.createElement($.Item,{eventKey:"history",icon:d.createElement(w,{icon:"history"})},"History"),d.createElement($.Item,{eventKey:"preset",icon:d.createElement(w,{icon:"list"})},"Collection"),d.createElement($.Item,{eventKey:"setting",icon:d.createElement(w,{icon:"setting"})},"Setting")),d.createElement(B,null,M[s])),d.createElement(u,{fluid:!0,style:{marginTop:"calc(3vh)",marginBottom:"calc(3vh)",marginLeft:"20px",marginRight:"20px",height:"calc(94vh)"}},d.createElement(p,{style:{height:"100%"}},d.createElement(E,{style:{height:"100%"},xs:10,xsPush:1},d.createElement(p,{style:{display:"flex",height:"100%",flexDirection:"column"}},d.createElement(O,{fluid:!0},d.createElement(k,null,d.createElement(x,null,"Server"),d.createElement("div",{style:{display:"flex"}},d.createElement(h,{style:{flex:1},block:!0,placeholder:"Please select server ...",value:c,onChange:m,onSearch:_,data:null==N?void 0:N.map((({name:e,id:t})=>({label:e,value:t})))}))),d.createElement(k,null,d.createElement(x,null,"Endpoint"),d.createElement("div",{style:{display:"flex"}},d.createElement(h,{style:{flex:1},block:!0,placeholder:"Please select endpoint ...",value:f,onChange:e=>{q("normal"),v(e)},onSearch:I,data:null==H?void 0:H.map((({endpoint:e})=>({label:e,value:e})))})))),d.createElement(L,{htmlElementProps:{style:{flex:1,marginBottom:20,marginTop:20}},ref:t,mode:"code",ace:D,value:{}}),C?d.createElement(P,{style:{textAlign:"center"},content:"Sending Request ..."}):d.createElement(g,{style:{width:"100%"},appearance:"primary",onClick:async()=>{if(!c||!f)return;S(!0),T(void 0);const t=Y(),r=e.view.getRequestJSON();window.addEventListener("message",(async s=>{const{responseTo:n,payload:a}=s.data||{};n==t&&(a.error&&T(a.message),e.view.setResponseJSON(a.result),await e.db.createHistory(c,f,r,a,a.error),S(!1),e.view.historyController.refresh())}),{once:!0});const s=await e.db.getServerById(c);e.vscode.postMessage({response:t,action:"grpc.call",payload:{service:s.name,endpoint:f,body:r}})}},d.createElement(w,{icon:"send"})," Send Request"))),d.createElement(E,{xs:10,xsPush:3,style:{display:"flex",flexDirection:"column",height:"100%"}},R&&d.createElement(j,{style:{marginBottom:20},type:"error",showIcon:!0,description:R}),d.createElement(L,{htmlElementProps:{style:{flex:1}},ref:r,mode:"code",ace:D,value:{}})))))}F.render(d.createElement(te.Provider,{value:ee},d.createElement(ue,null)),document.getElementById("root"));
