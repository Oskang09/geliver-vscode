var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,s=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,a=(e,a)=>{for(var o in a||(a={}))t.call(a,o)&&s(e,o,a[o]);if(r)for(var o of r(a))n.call(a,o)&&s(e,o,a[o]);return e},o=(e,t,r)=>(s(e,"symbol"!=typeof t?t+"":t,r),r);import{D as l,h as i,a as c,d as m,b as d,S as u,E as p,F as E,c as h,C as y,e as f,I as _,H as g,M as v,L as w,B as b,G as I,R as C,f as S,g as j,i as R,j as T,U as O,k,P as x,A,l as P,m as q,n as L,o as D,T as B,W as V,p as H,q as N,r as z,s as F,t as M,u as J}from"./vendor.fa37ab51.js";let U;!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(r){const n=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((r,a)=>{const o=new URL(e,n);if(self[t].moduleMap[o])return r(self[t].moduleMap[o]);const l=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){a(new Error(`Failed to import: ${e}`)),s(i)},onload(){r(self[t].moduleMap[o]),s(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/assets/");const $={},W=function(e,t){if(!t)return e();if(void 0===U){const e=document.createElement("link").relList;U=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in $)return;$[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":U,t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e()))};const G=/^[\],:{}\s]*$/,K=/\\(?:["\\/bfnrt]|u[0-9a-fA-F]{4})/g,Y=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?/g,Q=/(?:^|:|,)(?:\s*\[)+/g,X=async function(e="GET",t="",r={},n={}){const s=function(e,t){let r=e;t&&""!=l.stringify(t)&&(r+="?"+l.stringify(t));return r}(t,"GET"===e?r:void 0),a=Object.assign({},n),o={method:e,headers:a};if(console.log("FetchURI      : ",e,s),console.log("FetchHeader   : ",a),"GET"!==e){const e=JSON.stringify(r);Object.assign(o,{body:e}),console.log("FetchBody     : ",r)}try{const e=await fetch(s,o),t=await e.text();return console.log("FetchResponse : ",t),(i=t).length&&G.test(i.replace(K,"@").replace(Y,"]").replace(Q,""))?JSON.parse(t):t}catch(c){throw c}var i};class Z{constructor(){o(this,"reloadServerEndpoints",(async e=>await X("GET",e))),o(this,"sendRequest",(async(e,t,r)=>await X("POST",e,{endpoint:t,request:r})))}}class ee{constructor(){o(this,"getTheme",(()=>localStorage.getItem("oscrud.theme"))),o(this,"setTheme",(e=>{localStorage.setItem("oscrud.theme",e)})),o(this,"getAppTheme",(()=>localStorage.getItem("oscrud.app_theme"))),o(this,"setAppTheme",(e=>{localStorage.setItem("oscrud.app_theme",e)}))}}function te(){return i().format("x")+function(e){const t=[];for(let r=0;r<e;r++)t.push(Math.floor(10*Math.random()).toString());return t.join("")}(4)}let re=new c("geliver");if(re.version(1).stores({histories:"&id, serverId, endpoint, createdAt",servers:"&id, name, connection, updatedAt",collections:"&id, name, tag, updatedAt",presets:"&id, name, collectionId, serverId, endpoint, updatedAt"}),"vscode-webview"===(null==window?void 0:window.mode)){const e=require(window.database);re.import(e)}const ne=async(e,t="",r="id",n=!0,s=10)=>{t&&(e=e.where(r),e=n?e.belowOrEqual(t):e.aboveOrEqual(t));let a=e.limit(s+1);n&&(a=a.reverse());const o=await a.sortBy(r);let l;return o.length===s+1&&(l=o.pop()[r]),[o,l]};class se{constructor(){o(this,"exportDatabase",(async(e=(()=>{}))=>{const t=await re.export({progressCallback:e});m(t,"geliver.json","application/json")})),o(this,"importDatabase",(async(e,t=(()=>{}))=>{await re.delete(),await re.open(),await re.import(e,{progressCallback:t})})),o(this,"checkServerIdValid",(async e=>void 0===await re.servers.where("id").equals(e).first())),o(this,"getCollectionById",(async e=>re.collections.where("id").equals(e).first())),o(this,"getPresetById",(async e=>re.presets.where("id").equals(e).first())),o(this,"getServerById",(async e=>re.servers.where("id").equals(e).first())),o(this,"getConnectionById",(async e=>{const t=await re.servers.where("id").equals(e).first();return null==t?void 0:t.connection})),o(this,"listServers",(async e=>{let t=re.servers;return e&&(t=t.where("name").startsWithAnyOf(e)),t.limit(50).toArray()})),o(this,"listCollectionsWithSearch",(async e=>{let t=re.collections;return e&&(t=t.where("name").startsWithAnyOf(e)),t.limit(50).toArray()})),o(this,"listEndpoints",(async(e,t)=>{if(!e)return[];const r=await re.servers.where("id").equals(e).first();let n=(null==r?void 0:r.endpoints)||[];return t&&(n=n.filter((e=>e.endpoint.toLowerCase().includes(t.toLowerCase())))),n})),o(this,"listCollections",(async e=>ne(re.collections,e,"name",!1,8))),o(this,"listPresetsByCollectionId",(async(e,t)=>ne(re.presets.where("collectionId").equals(t),e,"name",!1,8))),o(this,"listHistories",(async e=>{const t={},r=async e=>(t[e]||(t[e]=this.getConnectionById(e)),t[e]),[n,s]=await ne(re.histories,e,"createdAt",!0,8),a=Promise.all(n.map((async e=>Object.assign(e,{connection:await r(e.serverId)}))));return[await a,s]})),o(this,"modifyServerEndpointsById",(async(e,t)=>{await re.servers.where("id").equals(e).modify({endpoints:t,updatedAt:i.utc().valueOf()})})),o(this,"modifyServerById",(async(e,t,r,n)=>{await re.servers.where("id").equals(e).modify({name:t,connection:r,endpoints:n,updatedAt:i.utc().valueOf()})})),o(this,"modifyCollectionById",(async(e,t,r)=>{await re.collections.where("id").equals(e).modify({name:t,tag:r,updatedAt:i.utc().valueOf()})})),o(this,"modifyPresetById",(async(e,t,r,n,s)=>{await re.presets.where("id").equals(id).modify({name:e,collectionId:t,serverId:r,endpoint:n,request:s,updatedAt:i.utc().valueOf()})})),o(this,"createCollection",(async(e,t)=>{await re.collections.put({id:te(),updatedAt:i.utc().valueOf(),name:e,tag:t})})),o(this,"createPreset",(async(e,t,r,n,s)=>{await re.presets.put({id:te(),updatedAt:i.utc().valueOf(),name:e,collectionId:t,serverId:r,endpoint:n,request:s})})),o(this,"createServer",(async(e,t,r,n)=>{await re.servers.put({id:e,name:t,connection:r,endpoints:n,updatedAt:i.utc().valueOf()})})),o(this,"createHistory",(async(e,t,r,n,s)=>{await re.histories.put({id:te(),serverId:e,endpoint:t,request:r,response:n,isError:s,createdAt:i.utc().valueOf()})})),o(this,"upsertPreset",(async(e,t,r,n,s)=>{e||(e=te()),await re.presets.put({id:e,name:t,serverId:r,endpoint:n,request:s,updatedAt:i.utc().valueOf()})})),o(this,"deletePresetById",(async e=>{await re.presets.where("id").equals(e).delete()})),o(this,"deleteCollectionById",(async e=>{await re.collections.where("id").equals(e).delete()})),o(this,"deleteHistoryById",(async e=>{await re.histories.where("id").equals(e).delete()})),o(this,"clearHistory",(async()=>{await re.histories.clear()}))}}class ae{constructor(){o(this,"getRequestJSON",(()=>this.request.jsonEditor.get())),o(this,"setRequestTheme",(e=>{this.request.jsonEditor.aceEditor.setTheme(`ace/theme/${e}`)})),o(this,"setResponseTheme",(e=>{this.response.jsonEditor.aceEditor.setTheme(`ace/theme/${e}`)})),o(this,"getAceTheme",(e=>`ace/theme/${e}`)),o(this,"setResponseJSON",(e=>{try{const t=JSON.parse(e);this.response.jsonEditor.set(t)}catch(t){this.response.jsonEditor.set(e)}})),o(this,"setRequestJSON",(e=>{try{const t=JSON.parse(e);this.request.jsonEditor.set(t)}catch(t){this.request.jsonEditor.set(e)}})),this.request=null,this.response=null,this.historyController={}}}class oe{constructor(){this.api=new Z(this),this.view=new ae(this),this.storage=new ee(this),this.db=new se(this)}}const le=d.createContext(new oe),{StringType:ie}=u.Types;function ce({open:e,selectedServerId:t,onClose:r}){const n=d.useRef(),s=d.useContext(le),[a,o]=d.useState(!1),[l,i]=d.useState({}),[c,m]=d.useState(void 0);let I=ie().isRequired("Server id is required");t||(I=I.addRule((async e=>s.db.checkServerIdValid(e)),"Server id must be unique."));const C=u.Model({serverId:I,name:ie().isRequired("Name is required"),connection:ie().isRequired("Connection is required").addRule((e=>e.includes("https://")||e.includes("http://")),"Connection must have protocol HTTP or HTTPS.")});d.useEffect((()=>{i({}),t&&async function(){const e=await s.db.getServerById(t);i({serverId:t,name:e.name,connection:e.connection})}()}),[t]);return d.createElement(p,{show:e,size:"xs",onClose:r},d.createElement(p.Header,{closeButton:!1},d.createElement(p.Title,null,t?"Edit":"Add"," Server")),d.createElement(p.Body,null,d.createElement(E,{ref:n,fluid:!0,model:C,formValue:l,onChange:i},d.createElement(h,null,d.createElement(y,null,"SID"),d.createElement(f,{name:"serverId",accepter:_,disabled:void 0!==t}),d.createElement(g,null,"SID is an unique identifier for preset and history to determine server connection configuration. It's will always make sure connection is up to date.")),d.createElement(h,null,d.createElement(y,null,"Name"),d.createElement(f,{name:"name",accepter:_})),d.createElement(h,null,d.createElement(y,null,"Connection"),d.createElement(f,{name:"connection",accepter:_}),d.createElement(g,null,"Example connection: http://localhost:1234"))),c&&d.createElement(v,{type:"error",showIcon:!0,description:c.message})),d.createElement(p.Footer,{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},a?d.createElement(w,{style:{marginRight:10},content:(t?"Updating":"Creating")+" ..."}):d.createElement(b,{appearance:"primary",onClick:async()=>{const{hasError:e}=await n.current.checkAsync();if(!e){m(void 0),o(!0);try{const e=await s.api.reloadServerEndpoints(l.connection);t?await s.db.modifyServerById(l.serverId,l.name,l.connection,e):await s.db.createServer(l.serverId,l.name,l.connection,e),r()}catch(a){m(a)}finally{o(!1)}}}},"Confirm"),d.createElement(b,{appearance:"subtle",onClick:r},"Cancel")))}const me=["ambiance","chaos","chrome","clouds","clouds_midnight","cobalt","crimson_editor","dawn","dracula","dreamweaver","eclipse","github","gob","gruvbox","idle_fingers","iplastic","katzenmilch","kr_theme","kuroir","merbivore","merbivore_soft","monokai","mono_industrial","pastel_on_dark","solarized_dark","solarized_light","sqlserver","terminal","textmate","tomorrow","tomorrow_night","tomorrow_night_blue","tomorrow_night_bright","tomorrow_night_eighties","twilight","vibrant_ink","xcode"];function de({theme:e,setTheme:t,appTheme:r,setAppTheme:n}){const s=d.useContext(le),[o,l]=d.useState(!1),[i,c]=d.useState(!1),[m,u]=d.useState(void 0),E=()=>{l(void 0)};return d.createElement(I,{fluid:!0},d.createElement(C,{style:{display:"flex",alignItems:"center"}},d.createElement(S,{xs:2},d.createElement("p",null,"Editor Theme")),d.createElement(S,{xs:6},d.createElement(j,{block:!0,value:e,onChange:t,data:me.map((e=>({label:e,value:e})))}))),d.createElement(C,{style:{display:"flex",alignItems:"center",marginTop:15}},d.createElement(S,{xs:2},d.createElement("p",null,"App Theme")),d.createElement(S,{xs:22},d.createElement(R,{inline:!0,value:r,onChange:n},d.createElement(T,{value:"light"},"☀️ Light"),d.createElement(T,{value:"dark"},"🌙 Dark")),d.createElement(g,null,"Sometimes may not working, refresh should take the changes."))),d.createElement(C,{style:{display:"flex",alignItems:"center",marginTop:15}},d.createElement(S,{xs:2},d.createElement("p",null,"Actions")),d.createElement(S,{xs:22,style:{display:"flex",flexDirection:"row"}},d.createElement(O,{fileListVisible:!1,autoUpload:!1,action:"",onChange:e=>{c("import");try{s.db.importDatabase(e[0].blobFile,(e=>u(a({},e))))}catch(t){u({error:t,done:!0})}}},d.createElement(b,null,d.createElement(k,{icon:"import"})," Import Data")),d.createElement(b,{style:{marginLeft:10},appearance:"primary",onClick:()=>{c("export"),s.db.exportDatabase((e=>u(a({},e))))}},d.createElement(k,{icon:"export"})," Export Data"),d.createElement(b,{style:{marginLeft:10},appearance:"primary",onClick:()=>l(!0)},d.createElement(k,{icon:"trash"})," Clear History"))),d.createElement(p,{show:void 0!==m,overflow:!1,size:"xs"},d.createElement(p.Header,{closeButton:!1},d.createElement(p.Title,null,d.createElement(k,{icon:"export"===i?"export":"import",style:{marginRight:10}}),"export"===i?"Exporting":"Importing"," Data")),d.createElement(p.Body,{style:{display:"flex",justifyContent:"center",flexDirection:"row"}},d.createElement(x.Circle,{style:{width:120},percent:Math.floor(((null==m?void 0:m.completedTables)+(null==m?void 0:m.completedRows))/((null==m?void 0:m.totalTables)+(null==m?void 0:m.totalRows))*100),status:(null==m?void 0:m.done)&&(m.error?"fail":"success")}),d.createElement("dl",{style:{marginLeft:30}},d.createElement("dt",null,"Num Of Tables:"),d.createElement("dd",null,null==m?void 0:m.completedTables," / ",null==m?void 0:m.totalTables),d.createElement("dt",null,"Num Of Rows:"),d.createElement("dd",null,null==m?void 0:m.completedRows," / ",null==m?void 0:m.totalRows))),(null==m?void 0:m.error)&&d.createElement(v,{type:"error",title:"Import Error",description:null==m?void 0:m.error.message}),(null==m?void 0:m.done)&&d.createElement(p.Footer,null,d.createElement(b,{appearance:"primary",onClick:()=>{u(void 0)}},"Close"))),d.createElement(p,{backdrop:!0,show:o,onHide:E,size:"xs"},d.createElement(p.Header,{closeButton:!1},d.createElement(p.Title,null,d.createElement(k,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Clear histories")),d.createElement(p.Body,null,"Histories once cleared will not be recover anymore. Are you sure want to proceed?"),d.createElement(p.Footer,null,d.createElement(b,{appearance:"primary",onClick:async()=>{A.info("Clearing histories ...");try{await s.db.clearHistory(),E(),A.success("Clear histories successfully"),s.view.historyController.refresh()}catch(e){A.error("Error when clearing histories: ",e.message)}}},"Ok"),d.createElement(b,{onClick:E,appearance:"subtle"},"Cancel"))))}const ue=Promise.resolve([[],void 0]);function pe(e){const[t,r]=d.useState(!1),[n,s]=d.useState(!1),[a,o]=d.useState(!1),[l,i]=d.useState(),[c,m]=d.useState([]);d.useEffect((()=>{a||n||(s(!0),async function(){const[t,r]=await e(l);m(l?[...c,...t]:[...t]),i(r),r||o(!0),s(!1)}())}),[t]);return[{loading:n,isEnd:a,refresh:()=>{n||(i(void 0),o(!1),r(!t))},loadMore:()=>{a||n||r(!t)}},c]}const{StringType:Ee}=u.Types;function he({open:e,selectedCollectionId:t,onClose:r}){const n=d.useRef(),s=d.useContext(le),[a,o]=d.useState(!1),[l,i]=d.useState({}),[c,m]=d.useState(void 0),I=u.Model({name:Ee().isRequired("Name is required")});d.useEffect((()=>{i({}),t&&async function(){const e=await s.db.getCollectionById(t);i({name:e.name,tag:e.tag})}()}),[t]);return d.createElement(p,{show:e,size:"xs",onHide:r},d.createElement(p.Header,{closeButton:!1},d.createElement(p.Title,null,t?"Edit":"Create"," Collection")),d.createElement(p.Body,null,d.createElement(E,{ref:n,fluid:!0,model:I,formValue:l,onChange:i},d.createElement(h,null,d.createElement(y,null,"Name"),d.createElement(f,{name:"name",accepter:_})),d.createElement(h,null,d.createElement(y,null,"Tag"),d.createElement(f,{name:"tag",accepter:_}),d.createElement(g,null,"Tag is just for display purpse, usually for specify development, staging or production. You can use as ur own recognize purpose."))),c&&d.createElement(v,{type:"error",showIcon:!0,description:c.message})),d.createElement(p.Footer,{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},a?d.createElement(w,{style:{marginRight:10},content:(t?"Updating":"Creating")+" ..."}):d.createElement(b,{appearance:"primary",onClick:async()=>{const{hasError:e}=await n.current.checkAsync();if(!e){m(void 0),o(!0);try{t?await s.db.modifyCollectionById(t,l.name,l.tag):await s.db.createCollection(l.name,l.tag),r()}catch(a){m(a)}finally{o(!1)}}}},"Confirm"),d.createElement(b,{appearance:"subtle",onClick:r},"Cancel")))}const{StringType:ye}=u.Types;function fe({open:e,selectedPresetId:t,onClose:r}){const n=d.useRef(),s=d.useRef(),a=d.useContext(le),[o,l]=d.useState(!1),[i,c]=d.useState({}),[m,I]=d.useState(void 0),[C,S]=d.useState([]),[R,T]=d.useState([]),[O,k]=d.useState([]),[x,A]=d.useState(),[L,D]=d.useState(),[B,V]=d.useState(),H=u.Model({name:ye().isRequired("Name is required"),collectionId:ye().isRequired("Collection is required"),serverId:ye().isRequired("Server is required"),endpoint:ye().isRequired("Endpoint is required")});d.useEffect((()=>{c({}),t&&async function(){const e=await a.db.getPresetById(t);s.current.jsonEditor.set(e.request),c({name:e.name,collectionId:e.collectionId,serverId:e.serverId,endpoint:e.endpoint,request:e.request})}()}),[t]),d.useEffect((()=>{!async function(){const e=await a.db.listCollectionsWithSearch(x);T(e)}()}),[x]),d.useEffect((()=>{!async function(){const e=await a.db.listServers(L);S(e)}()}),[L]),d.useEffect((()=>{!async function(){const e=await a.db.listEndpoints(i.serverId,B);k(e)}()}),[i.serverId,B]),d.useEffect((()=>{if(i.endpoint&&!t){const e=O.find((e=>e.endpoint===i.endpoint)).request,t=JSON.parse(e);s.current.jsonEditor.set(t)}}),[i.endpoint]);return d.createElement(p,{show:e,size:"xs",onHide:r,size:"md",overflow:!1},d.createElement(p.Header,{closeButton:!1},d.createElement(p.Title,null,t?"Edit":"Create"," Preset")),d.createElement(p.Body,null,d.createElement(E,{ref:n,fluid:!0,model:H,formValue:i,onChange:c},d.createElement(h,null,d.createElement(y,null,"Name"),d.createElement(f,{name:"name",accepter:_})),d.createElement(h,null,d.createElement(y,null,"Collection"),d.createElement(f,{name:"collectionId",accepter:j,block:!0,onSearch:A,data:null==R?void 0:R.map((({name:e,id:t})=>({label:e,value:t})))}),d.createElement(g,null,"Currently only support single layer grouping, nested is not supported.")),d.createElement(h,null,d.createElement(y,null,"Server"),d.createElement(f,{name:"serverId",accepter:j,block:!0,onSearch:D,data:null==C?void 0:C.map((({name:e,id:t,connection:r})=>({label:`${e} ( ${r} )`,value:t})))})),d.createElement(h,null,d.createElement(y,null,"Endpoint"),d.createElement(f,{name:"endpoint",accepter:j,block:!0,onSearch:V,data:null==O?void 0:O.map((({endpoint:e})=>({label:e,value:e})))})),d.createElement(h,null,d.createElement(y,null,"Request"),d.createElement(P,{ref:s,htmlElementProps:{style:{height:500}},mode:"code",theme:a.view.getAceTheme(a.storage.getTheme()),ace:q,value:{}}))),m&&d.createElement(v,{type:"error",showIcon:!0,description:m.message})),d.createElement(p.Footer,{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},o?d.createElement(w,{style:{marginRight:10},content:(t?"Updating":"Creating")+" ..."}):d.createElement(b,{appearance:"primary",onClick:async()=>{const{hasError:e}=await n.current.checkAsync();if(!e){I(void 0),l(!0);try{const e=s.current.jsonEditor.get();t?await a.db.modifyPresetById(t,i.name,i.collectionId,i.serverId,i.endpoint,e):await a.db.createPreset(i.name,i.collectionId,i.serverId,i.endpoint,e),r()}catch(o){I(o)}finally{l(!1)}}}},"Confirm"),d.createElement(b,{appearance:"subtle",onClick:r},"Cancel")))}function _e({setCurrent:e,setServerId:t,setEndpoint:r}){const n=d.useContext(le),[s,a]=d.useState(void 0),[o,l]=d.useState(void 0),[i,c]=d.useState(void 0),[m,u]=d.useState(void 0),[E,h]=d.useState(void 0),[y,f]=d.useState(void 0),[_,g]=pe(n.db.listCollections),[v,w]=pe((e=>m?n.db.listPresetsByCollectionId(e,m):ue));let I=L;I=L.default;return d.createElement(d.Fragment,null,d.createElement(he,{open:i,selectedCollectionId:m,onClose:()=>{c(void 0),_.refresh()}}),d.createElement(fe,{open:E,selectedPresetId:y,onClose:()=>{h(void 0),v.refresh()}}),d.createElement(p,{backdrop:!0,show:void 0!==s,onHide:()=>a(void 0),size:"xs"},d.createElement(p.Header,{closeButton:!1},d.createElement(p.Title,null,d.createElement(k,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete collection")),d.createElement(p.Body,null,"Collection once deleted will not be recover anymore. All of the preset under collection will be deleted also. Are you sure want to proceed?"),d.createElement(p.Footer,null,d.createElement(b,{appearance:"primary",onClick:async()=>{A.info("Deleting collection ...");try{await n.db.deleteCollectionById(s),A.success("Delete collection successfully"),a(void 0),_.refresh()}catch(e){A.error("Error when deleting collection: ",e.message)}}},"Ok"),d.createElement(b,{onClick:()=>a(void 0),appearance:"subtle"},"Cancel"))),d.createElement(p,{backdrop:!0,show:void 0!==o,onHide:()=>l(void 0),size:"xs"},d.createElement(p.Header,{closeButton:!1},d.createElement(p.Title,null,d.createElement(k,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete preset")),d.createElement(p.Body,null,"Preset once deleted will not be recover anymore. Are you sure want to proceed?"),d.createElement(p.Footer,null,d.createElement(b,{appearance:"primary",onClick:async()=>{A.info("Deleting preset ...");try{await n.db.deletePresetById(o),A.success("Delete preset successfully"),l(void 0),v.refresh()}catch(e){A.error("Error when deleting preset: ",e.message)}}},"Ok"),d.createElement(b,{onClick:()=>l(void 0),appearance:"subtle"},"Cancel"))),d.createElement(b,{appearance:"primary",onClick:()=>{c(!0),u(void 0)}},d.createElement(k,{icon:"plus"})," Create Collection"),d.createElement(b,{style:{marginLeft:15},appearance:"primary",onClick:()=>{h(!0),f(void 0)}},d.createElement(k,{icon:"plus"})," Create Preset"),d.createElement("div",{style:{marginTop:10,marginBottom:10}},(null==g?void 0:g.length)>0?d.createElement(I,{onLastItemVisible:null==_?void 0:_.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:g.map((e=>d.createElement("div",{key:e.id,style:{margin:10}},d.createElement(D,{style:m===e.id?{border:"1px solid #4BB543"}:{},className:"folder-panel",onClick:()=>(e=>{u(e.id),v.refresh()})(e),bordered:!0},d.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"baseline"}},m===e.id?d.createElement(k,{icon:"folder-open"}):d.createElement(k,{icon:"folder"}),d.createElement("p",{style:{marginLeft:10}},e.name," ",e.tag&&d.createElement(B,{style:{marginLeft:5}},e.tag)),d.createElement(V,{trigger:"click",placement:"bottom",speaker:d.createElement(H,{full:!0},d.createElement(N.Menu,null,d.createElement(N.Item,{icon:d.createElement(k,{icon:"edit"}),onSelect:()=>(e=>{c(!0),u(e.id)})(e)},"Edit"),d.createElement(N.Item,{icon:d.createElement(k,{icon:"trash"}),onSelect:()=>a(e.id)},"Delete")))},d.createElement(k,{style:{marginLeft:15},icon:"ellipsis-h"})))))))}):d.createElement("h4",{style:{textAlign:"center"}},"You don't have any collection yet. Create your first collection now!")),m&&((null==w?void 0:w.length)>0?d.createElement(I,{onLastItemVisible:null==v?void 0:v.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:w.map((s=>d.createElement("div",{key:s.id,style:{margin:10}},d.createElement(D,{className:"preset-panel",onClick:()=>(s=>{e("preset"),t(s.serverId),r(s.endpoint),n.view.setRequestJSON(s.request),n.view.setResponseJSON({})})(s),bordered:!0},d.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},d.createElement("p",{style:{marginLeft:5}},"( ",s.endpoint," ) ",s.name),d.createElement(V,{trigger:"click",placement:"bottom",speaker:d.createElement(H,{full:!0},d.createElement(N.Menu,null,d.createElement(N.Item,{icon:d.createElement(k,{icon:"edit"}),onSelect:()=>(e=>{h(!0),f(e.id)})(s)},"Edit"),d.createElement(N.Item,{icon:d.createElement(k,{icon:"trash"}),onSelect:()=>l(s.id)},"Delete")))},d.createElement(k,{style:{marginLeft:15},icon:"ellipsis-h"})))))))}):d.createElement("h4",{style:{textAlign:"center"}},"You don't have any preset yet. Create your first preset now!")))}function ge({setCurrent:e,setServerId:t,setEndpoint:r}){const n=d.useContext(le),[s,a]=d.useState(void 0),[o,l]=pe(n.db.listHistories);d.useEffect((()=>{n.view.historyController=o}),[o]);const i=()=>{a(void 0)};let c=L;return c=L.default,d.createElement(d.Fragment,null,(null==l?void 0:l.length)>0?d.createElement(c,{onLastItemVisible:null==o?void 0:o.loadMore,alignCenter:!1,itemStyle:{outline:"none"},data:l.map((s=>d.createElement("div",{key:s.id,style:{margin:10}},d.createElement(D,{bordered:!0,className:"history-panel",onClick:()=>(s=>{e("history"),t(s.serverId),r(s.endpoint),n.view.setRequestJSON(s.request),n.view.setResponseJSON(s.response)})(s)},d.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},s.isError?d.createElement(B,{color:"red"},"ERROR"):d.createElement(B,{color:"green"},"SUCCESS"),d.createElement("p",{style:{marginLeft:5}},"( ",s.endpoint," ) ",s.connection),d.createElement(z,{style:{marginLeft:5},appearance:"subtle",icon:d.createElement(k,{icon:"trash"}),onClick:()=>a(s.id)}))))))}):d.createElement("h4",{style:{textAlign:"center"}},"You don't have any history yet. Start with your first request now!"),d.createElement(p,{backdrop:!0,show:void 0!==s,onHide:i,size:"xs"},d.createElement(p.Header,{closeButton:!1},d.createElement(p.Title,null,d.createElement(k,{icon:"remind",style:{color:"#ffb300",marginRight:10}}),"Delete history")),d.createElement(p.Body,null,"History once deleted will not be recover anymore. Are you sure want to proceed?"),d.createElement(p.Footer,null,d.createElement(b,{appearance:"primary",onClick:async()=>{A.info("Deleting history ...");try{await n.db.deleteHistoryById(s),i(),A.success("Delete history successfully"),o.refresh()}catch(e){A.error("Error when deleting history: ",e.message)}}},"Ok"),d.createElement(b,{onClick:i,appearance:"subtle"},"Cancel"))))}function ve(){const e=d.useContext(le),[t,r]=d.useState(!1),[n,s]=[d.useRef(),d.useRef()],[a,o]=d.useState("history"),[l,i]=d.useState(e.storage.getTheme()),[c,m]=d.useState(e.storage.getAppTheme()),[u,p]=d.useState(),[f,_]=d.useState(""),[g,R]=d.useState(),[T,O]=d.useState(),[x,A]=d.useState(!1),[L,B]=d.useState(!1),[V,H]=d.useState(void 0),[N,J]=d.useState("normal");let U=null;const $=F.useLiveQuery((()=>e.db.listServers(f)),[t,f]),G=F.useLiveQuery((()=>e.db.listEndpoints(u,T)),[u,T,x]);d.useEffect((()=>{s.current.jsonEditor.aceEditor.setOptions({readOnly:!0}),e.view.request=n.current,e.view.response=s.current}),[]),d.useEffect((()=>{g&&"normal"===N&&(e.view.setRequestJSON(G.find((e=>e.endpoint===g)).request),e.view.setResponseJSON({}))}),[g]),d.useEffect((()=>{l&&function(e){switch(e){case"./assets/themes/ambiance.js":return W((()=>__import__("./ambiance.7be3e4f0.js")),void 0);case"./assets/themes/chaos.js":return W((()=>__import__("./chaos.4b6f8594.js")),void 0);case"./assets/themes/chrome.js":return W((()=>__import__("./chrome.fd151685.js")),void 0);case"./assets/themes/clouds.js":return W((()=>__import__("./clouds.1da898e5.js")),void 0);case"./assets/themes/clouds_midnight.js":return W((()=>__import__("./clouds_midnight.1de33a39.js")),void 0);case"./assets/themes/cobalt.js":return W((()=>__import__("./cobalt.e2730c60.js")),void 0);case"./assets/themes/crimson_editor.js":return W((()=>__import__("./crimson_editor.e68cc107.js")),void 0);case"./assets/themes/dawn.js":return W((()=>__import__("./dawn.aaa40555.js")),void 0);case"./assets/themes/dracula.js":return W((()=>__import__("./dracula.fc88cdc2.js")),void 0);case"./assets/themes/dreamweaver.js":return W((()=>__import__("./dreamweaver.78ea346b.js")),void 0);case"./assets/themes/eclipse.js":return W((()=>__import__("./eclipse.2c70757f.js")),void 0);case"./assets/themes/github.js":return W((()=>__import__("./github.852f1cb3.js")),void 0);case"./assets/themes/gob.js":return W((()=>__import__("./gob.f70d9ed8.js")),void 0);case"./assets/themes/gruvbox.js":return W((()=>__import__("./gruvbox.d513ca79.js")),void 0);case"./assets/themes/idle_fingers.js":return W((()=>__import__("./idle_fingers.30dfedad.js")),void 0);case"./assets/themes/iplastic.js":return W((()=>__import__("./iplastic.848db36b.js")),void 0);case"./assets/themes/katzenmilch.js":return W((()=>__import__("./katzenmilch.e6f46fc5.js")),void 0);case"./assets/themes/kr_theme.js":return W((()=>__import__("./kr_theme.1d624c2a.js")),void 0);case"./assets/themes/kuroir.js":return W((()=>__import__("./kuroir.1f7e9c89.js")),void 0);case"./assets/themes/merbivore.js":return W((()=>__import__("./merbivore.75dff3f5.js")),void 0);case"./assets/themes/merbivore_soft.js":return W((()=>__import__("./merbivore_soft.228a4016.js")),void 0);case"./assets/themes/monokai.js":return W((()=>__import__("./monokai.90dc2f00.js")),void 0);case"./assets/themes/mono_industrial.js":return W((()=>__import__("./mono_industrial.833e4398.js")),void 0);case"./assets/themes/pastel_on_dark.js":return W((()=>__import__("./pastel_on_dark.fd793d99.js")),void 0);case"./assets/themes/solarized_dark.js":return W((()=>__import__("./solarized_dark.07c5862d.js")),void 0);case"./assets/themes/solarized_light.js":return W((()=>__import__("./solarized_light.f77d4588.js")),void 0);case"./assets/themes/sqlserver.js":return W((()=>__import__("./sqlserver.fe7518c0.js")),void 0);case"./assets/themes/terminal.js":return W((()=>__import__("./terminal.1a354bde.js")),void 0);case"./assets/themes/textmate.js":return W((()=>__import__("./textmate.8a9e25f6.js")),void 0);case"./assets/themes/tomorrow.js":return W((()=>__import__("./tomorrow.ee6c907c.js")),void 0);case"./assets/themes/tomorrow_night.js":return W((()=>__import__("./tomorrow_night.2ecd9f6c.js")),void 0);case"./assets/themes/tomorrow_night_blue.js":return W((()=>__import__("./tomorrow_night_blue.bd316ae0.js")),void 0);case"./assets/themes/tomorrow_night_bright.js":return W((()=>__import__("./tomorrow_night_bright.4bcef419.js")),void 0);case"./assets/themes/tomorrow_night_eighties.js":return W((()=>__import__("./tomorrow_night_eighties.0b405491.js")),void 0);case"./assets/themes/twilight.js":return W((()=>__import__("./twilight.7494f210.js")),void 0);case"./assets/themes/vibrant_ink.js":return W((()=>__import__("./vibrant_ink.4daa84e6.js")),void 0);case"./assets/themes/xcode.js":return W((()=>__import__("./xcode.45aaf43c.js")),void 0);default:return Promise.reject(new Error("Unknown variable dynamic import: "+e))}}(`./assets/themes/${l}.js`).then((()=>{e.view.setRequestTheme(l),e.view.setResponseTheme(l),e.storage.setTheme(l)}))}),[l]),d.useEffect((()=>{U&&U.parentNode.removeChild(U),U=document.createElement("link"),U.rel="stylesheet",U.href=`./${c}.css`,U.dataset.theme=c,document.head.appendChild(U),e.storage.setAppTheme(c)}),[c]);const K={setting:d.createElement(de,{theme:l,setTheme:i,appTheme:c,setAppTheme:m}),preset:d.createElement(_e,{setCurrent:J,setServerId:p,setEndpoint:R}),history:d.createElement(ge,{setCurrent:J,setServerId:p,setEndpoint:R})};return d.createElement("div",null,d.createElement(ce,{selectedServerId:u,open:t,onClose:()=>r(!1)}),d.createElement(D,{style:{marginLeft:40,marginRight:40}},d.createElement(M,{appearance:"tabs",activeKey:a,onSelect:o},d.createElement(M.Item,{eventKey:"history",icon:d.createElement(k,{icon:"history"})},"History"),d.createElement(M.Item,{eventKey:"preset",icon:d.createElement(k,{icon:"list"})},"Collection"),d.createElement(M.Item,{eventKey:"setting",icon:d.createElement(k,{icon:"setting"})},"Setting")),d.createElement(D,null,K[a])),d.createElement(I,{fluid:!0,style:{marginTop:"calc(3vh)",marginBottom:"calc(3vh)",marginLeft:"20px",marginRight:"20px",height:"calc(94vh)"}},d.createElement(C,{style:{height:"100%"}},d.createElement(S,{style:{height:"100%"},xs:10,xsPush:1},d.createElement(C,{style:{display:"flex",height:"100%",flexDirection:"column"}},d.createElement(E,{fluid:!0},d.createElement(h,null,d.createElement(y,null,"Server"),d.createElement("div",{style:{display:"flex"}},d.createElement(j,{style:{flex:1},block:!0,placeholder:"Please select server ...",value:u,onChange:p,onSearch:_,data:null==$?void 0:$.map((({name:e,id:t})=>({label:e,value:t})))}),d.createElement(z,{appearances:"primary",style:{marginLeft:10},icon:d.createElement(k,{icon:u?"edit2":"plus"}),onClick:()=>r(!0)}))),d.createElement(h,null,d.createElement(y,null,"Endpoint"),d.createElement("div",{style:{display:"flex"}},d.createElement(j,{style:{flex:1},block:!0,placeholder:"Please select endpoint ...",value:g,onChange:e=>{J("normal"),R(e)},onSearch:O,data:null==G?void 0:G.map((({endpoint:e})=>({label:e,value:e})))}),d.createElement(z,{appearance:"primary",style:{marginLeft:10},icon:d.createElement(k,{icon:"reload"}),onClick:async()=>{if(u){H(void 0);try{const t=await e.db.getConnectionById(u),r=await e.api.reloadServerEndpoints(t);await e.db.modifyServerEndpointsById(u,r),A(!x)}catch(t){H(t)}}}})))),d.createElement(P,{htmlElementProps:{style:{flex:1,marginBottom:20}},ref:n,mode:"code",ace:q,value:{}}),L?d.createElement(w,{style:{textAlign:"center"},content:"Sending Request ..."}):d.createElement(b,{style:{width:"100%"},appearance:"primary",onClick:async()=>{if(u&&g){B(!0),H(void 0);try{const t=e.view.getRequestJSON(),r=await e.db.getConnectionById(u),n=await e.api.sendRequest(r,g,t),s="string"==typeof n;await e.db.createHistory(u,g,t,n,s),e.view.setResponseJSON(n),e.view.historyController.refresh()}catch(t){H(t)}finally{B(!1)}}}},d.createElement(k,{icon:"send"})," Send Request"))),d.createElement(S,{xs:10,xsPush:3,style:{display:"flex",flexDirection:"column",height:"100%"}},V&&d.createElement(v,{style:{marginBottom:20},type:"error",showIcon:!0,description:V.message}),d.createElement(P,{htmlElementProps:{style:{flex:1}},ref:s,mode:"code",ace:q,value:{}})))))}J.render(d.createElement(le.Provider,{value:new oe},d.createElement(ve,null)),document.getElementById("root"));
